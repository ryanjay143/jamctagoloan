import{R as ie,r as V,j as t,t as z,I as me,B as ae,F as he,C as rt,w as Ee,D as nt,s as st,E as it}from"./index-B92hSL1o.js";import{A as ot,a as lt,b as ct}from"./avatar-DYlb4dHu.js";import{C as dt,a as ut,T as ft,b as mt,c as pe,d as J,e as ht,f as W,j as vt}from"./card-BwyMEh0j.js";import{a as ye}from"./axios-1xl_CE3x.js";import{S as se}from"./sweetalert2.esm.all-B0Dix5B2.js";import{D as _e,b as Be,c as Re,d as Pe,e as Me,f as ke,g as gt,a as xt}from"./dialog-C4ZCQWYQ.js";import{S as ce,a as de,b as ue,c as fe,d as K}from"./select-B5AUrNEg.js";import{c as Le,n as pt,s as Ve,f as yt}from"./format-B3-TfKxp.js";import"./index-D7ZFRxTW.js";import"./index-CZEUgMKf.js";function bt(e){return Le(e,Date.now())}function jt(e,a,r){const[s,n]=pt(r==null?void 0:r.in,e,a);return+Ve(s)==+Ve(n)}function Nt(e,a){return jt(Le(e,e),bt(e))}function Ge(e,a){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&a.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(e);n<s.length;n++)a.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(r[s[n]]=e[s[n]]);return r}var ve;(function(e){e.event="event",e.props="prop"})(ve||(ve={}));function te(){}function St(e){var a,r=void 0;return function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return a&&s.length===a.length&&s.every(function(i,m){return i===a[m]})||(a=s,r=e.apply(void 0,s)),r}}function ge(e){return!!(e||"").match(/\d/)}function oe(e){return e==null}function wt(e){return typeof e=="number"&&isNaN(e)}function $e(e){return oe(e)||wt(e)||typeof e=="number"&&!isFinite(e)}function He(e){return e.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")}function Ct(e){switch(e){case"lakh":return/(\d+?)(?=(\d\d)+(\d)(?!\d))(\.\d+)?/g;case"wan":return/(\d)(?=(\d{4})+(?!\d))/g;case"thousand":default:return/(\d)(?=(\d{3})+(?!\d))/g}}function Dt(e,a,r){var s=Ct(r),n=e.search(/[1-9]/);return n=n===-1?e.length:n,e.substring(0,n)+e.substring(n,e.length).replace(s,"$1"+a)}function Tt(e){var a=V.useRef(e);a.current=e;var r=V.useRef(function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return a.current.apply(a,s)});return r.current}function De(e,a){a===void 0&&(a=!0);var r=e[0]==="-",s=r&&a;e=e.replace("-","");var n=e.split("."),i=n[0],m=n[1]||"";return{beforeDecimal:i,afterDecimal:m,hasNegation:r,addNegation:s}}function Vt(e){if(!e)return e;var a=e[0]==="-";a&&(e=e.substring(1,e.length));var r=e.split("."),s=r[0].replace(/^0+/,"")||"0",n=r[1]||"";return(a?"-":"")+s+(n?"."+n:"")}function Ke(e,a,r){for(var s="",n=r?"0":"",i=0;i<=a-1;i++)s+=e[i]||n;return s}function Ie(e,a){return Array(a+1).join(e)}function Ue(e){var a=e+"",r=a[0]==="-"?"-":"";r&&(a=a.substring(1));var s=a.split(/[eE]/g),n=s[0],i=s[1];if(i=Number(i),!i)return r+n;n=n.replace(".","");var m=1+i,p=n.length;return m<0?n="0."+Ie("0",Math.abs(m))+n:m>=p?n=n+Ie("0",m-p):n=(n.substring(0,m)||"0")+"."+n.substring(m),r+n}function Ae(e,a,r){if(["","-"].indexOf(e)!==-1)return e;var s=(e.indexOf(".")!==-1||r)&&a,n=De(e),i=n.beforeDecimal,m=n.afterDecimal,p=n.hasNegation,S=parseFloat("0."+(m||"0")),C=m.length<=a?"0."+m:S.toFixed(a),D=C.split("."),j=i;i&&Number(D[0])&&(j=i.split("").reverse().reduce(function(A,T,y){return A.length>y?(Number(A[0])+Number(T)).toString()+A.substring(1,A.length):T+A},D[0]));var h=Ke(D[1]||"",a,r),g=p?"-":"",c=s?".":"";return""+g+j+c+h}function re(e,a){if(e.value=e.value,e!==null){if(e.createTextRange){var r=e.createTextRange();return r.move("character",a),r.select(),!0}return e.selectionStart||e.selectionStart===0?(e.focus(),e.setSelectionRange(a,a),!0):(e.focus(),!1)}}var We=St(function(e,a){for(var r=0,s=0,n=e.length,i=a.length;e[r]===a[r]&&r<n;)r++;for(;e[n-1-s]===a[i-1-s]&&i-s>r&&n-s>r;)s++;return{from:{start:r,end:n-s},to:{start:r,end:i-s}}}),It=function(e,a){var r=Math.min(e.selectionStart,a);return{from:{start:r,end:e.selectionEnd},to:{start:r,end:a}}};function At(e,a,r){return Math.min(Math.max(e,a),r)}function Ce(e){return Math.max(e.selectionStart,e.selectionEnd)}function Ft(){return typeof navigator<"u"&&!(navigator.platform&&/iPhone|iPod/.test(navigator.platform))}function Ot(e){return{from:{start:0,end:0},to:{start:0,end:e.length},lastValue:""}}function Et(e){var a=e.currentValue,r=e.formattedValue,s=e.currentValueIndex,n=e.formattedValueIndex;return a[s]===r[n]}function _t(e,a,r,s,n,i,m){m===void 0&&(m=Et);var p=n.findIndex(function($){return $}),S=e.slice(0,p);!a&&!r.startsWith(S)&&(a=S,r=S+r,s=s+S.length);for(var C=r.length,D=e.length,j={},h=new Array(C),g=0;g<C;g++){h[g]=-1;for(var c=0,A=D;c<A;c++){var T=m({currentValue:r,lastValue:a,formattedValue:e,currentValueIndex:g,formattedValueIndex:c});if(T&&j[c]!==!0){h[g]=c,j[c]=!0;break}}}for(var y=s;y<C&&(h[y]===-1||!i(r[y]));)y++;var P=y===C||h[y]===-1?D:h[y];for(y=s-1;y>0&&h[y]===-1;)y--;var R=y===-1||h[y]===-1?0:h[y]+1;return R>P?P:s-R<P-s?R:P}function Fe(e,a,r,s){var n=e.length;if(a=At(a,0,n),s==="left"){for(;a>=0&&!r[a];)a--;a===-1&&(a=r.indexOf(!0))}else{for(;a<=n&&!r[a];)a++;a>n&&(a=r.lastIndexOf(!0))}return a===-1&&(a=n),a}function Bt(e){for(var a=Array.from({length:e.length+1}).map(function(){return!0}),r=0,s=a.length;r<s;r++)a[r]=!!(ge(e[r])||ge(e[r-1]));return a}function ze(e,a,r,s,n,i){i===void 0&&(i=te);var m=Tt(function(c,A){var T,y;return $e(c)?(y="",T=""):typeof c=="number"||A?(y=typeof c=="number"?Ue(c):c,T=s(y)):(y=n(c,void 0),T=s(y)),{formattedValue:T,numAsString:y}}),p=V.useState(function(){return m(oe(e)?a:e,r)}),S=p[0],C=p[1],D=function(c,A){c.formattedValue!==S.formattedValue&&C({formattedValue:c.formattedValue,numAsString:c.value}),i(c,A)},j=e,h=r;oe(e)&&(j=S.numAsString,h=!0);var g=m(j,h);return V.useMemo(function(){C(g)},[g.formattedValue]),[S,D]}function Rt(e){return e.replace(/[^0-9]/g,"")}function Pt(e){return e}function Mt(e){var a=e.type;a===void 0&&(a="text");var r=e.displayType;r===void 0&&(r="input");var s=e.customInput,n=e.renderText,i=e.getInputRef,m=e.format;m===void 0&&(m=Pt);var p=e.removeFormatting;p===void 0&&(p=Rt);var S=e.defaultValue,C=e.valueIsNumericString,D=e.onValueChange,j=e.isAllowed,h=e.onChange;h===void 0&&(h=te);var g=e.onKeyDown;g===void 0&&(g=te);var c=e.onMouseUp;c===void 0&&(c=te);var A=e.onFocus;A===void 0&&(A=te);var T=e.onBlur;T===void 0&&(T=te);var y=e.value,P=e.getCaretBoundary;P===void 0&&(P=Bt);var R=e.isValidInputCharacter;R===void 0&&(R=ge);var $=e.isCharacterSame,H=Ge(e,["type","displayType","customInput","renderText","getInputRef","format","removeFormatting","defaultValue","valueIsNumericString","onValueChange","isAllowed","onChange","onKeyDown","onMouseUp","onFocus","onBlur","value","getCaretBoundary","isValidInputCharacter","isCharacterSame"]),q=ze(y,S,!!C,m,p,D),x=q[0],o=x.formattedValue,v=x.numAsString,d=q[1],f=V.useRef(),F=V.useRef({formattedValue:o,numAsString:v}),L=function(l,u){F.current={formattedValue:l.formattedValue,numAsString:l.value},d(l,u)},Q=V.useState(!1),Z=Q[0],w=Q[1],b=V.useRef(null),O=V.useRef({setCaretTimeout:null,focusTimeout:null});V.useEffect(function(){return w(!0),function(){clearTimeout(O.current.setCaretTimeout),clearTimeout(O.current.focusTimeout)}},[]);var M=m,k=function(l,u){var N=parseFloat(u);return{formattedValue:l,value:u,floatValue:isNaN(N)?void 0:N}},B=function(l,u,N){l.selectionStart===0&&l.selectionEnd===l.value.length||(re(l,u),O.current.setCaretTimeout=setTimeout(function(){l.value===N&&l.selectionStart!==u&&re(l,u)},0))},G=function(l,u,N){return Fe(l,u,P(l),N)},ne=function(l,u,N){var E=P(u),U=_t(u,o,l,N,E,R,$);return U=Fe(u,U,E),U},je=function(l){var u=l.formattedValue;u===void 0&&(u="");var N=l.input,E=l.source,U=l.event,_=l.numAsString,I;if(N){var Y=l.inputValue||N.value,X=Ce(N);N.value=u,I=ne(Y,u,X),I!==void 0&&B(N,I,u)}u!==o&&L(k(u,_),{event:U,source:E})};V.useEffect(function(){var l=F.current,u=l.formattedValue,N=l.numAsString;(o!==u||v!==N)&&L(k(o,v),{event:void 0,source:ve.props})},[o,v]);var le=b.current?Ce(b.current):void 0,xe=typeof window<"u"?V.useLayoutEffect:V.useEffect;xe(function(){var l=b.current;if(o!==F.current.formattedValue&&l){var u=ne(F.current.formattedValue,o,le);l.value=o,B(l,u,o)}},[o]);var Ne=function(l,u,N){var E=u.target,U=f.current?It(f.current,E.selectionEnd):We(o,l),_=Object.assign(Object.assign({},U),{lastValue:o}),I=p(l,_),Y=M(I);if(I=p(Y,void 0),j&&!j(k(Y,I))){var X=u.target,ee=Ce(X),we=ne(l,o,ee);return X.value=o,B(X,we,o),!1}return je({formattedValue:Y,numAsString:I,inputValue:l,event:u,source:N,input:u.target}),!0},Se=function(l,u){u===void 0&&(u=0);var N=l.selectionStart,E=l.selectionEnd;f.current={selectionStart:N,selectionEnd:E+u}},Qe=function(l){var u=l.target,N=u.value,E=Ne(N,l,ve.event);E&&h(l),f.current=void 0},Ye=function(l){var u=l.target,N=l.key,E=u.selectionStart,U=u.selectionEnd,_=u.value;_===void 0&&(_="");var I;N==="ArrowLeft"||N==="Backspace"?I=Math.max(E-1,0):N==="ArrowRight"?I=Math.min(E+1,_.length):N==="Delete"&&(I=E);var Y=0;N==="Delete"&&E===U&&(Y=1);var X=N==="ArrowLeft"||N==="ArrowRight";if(I===void 0||E!==U&&!X){g(l),Se(u,Y);return}var ee=I;if(X){var we=N==="ArrowLeft"?"left":"right";ee=G(_,I,we),ee!==I&&l.preventDefault()}else N==="Delete"&&!R(_[I])?ee=G(_,I,"right"):N==="Backspace"&&!R(_[I])&&(ee=G(_,I,"left"));ee!==I&&B(u,ee,_),g(l),Se(u,Y)},Je=function(l){var u=l.target,N=function(){var E=u.selectionStart,U=u.selectionEnd,_=u.value;if(_===void 0&&(_=""),E===U){var I=G(_,E);I!==E&&B(u,I,_)}};N(),requestAnimationFrame(function(){N()}),c(l),Se(u)},Xe=function(l){l.persist&&l.persist();var u=l.target,N=l.currentTarget;b.current=u,O.current.focusTimeout=setTimeout(function(){var E=u.selectionStart,U=u.selectionEnd,_=u.value;_===void 0&&(_="");var I=G(_,E);I!==E&&!(E===0&&U===_.length)&&B(u,I,_),A(Object.assign(Object.assign({},l),{currentTarget:N}))},0)},et=function(l){b.current=null,clearTimeout(O.current.focusTimeout),clearTimeout(O.current.setCaretTimeout),T(l)},tt=Z&&Ft()?"numeric":void 0,Te=Object.assign({inputMode:tt},H,{type:a,value:o,onChange:Qe,onKeyDown:Ye,onMouseUp:Je,onFocus:Xe,onBlur:et});if(r==="text")return n?ie.createElement(ie.Fragment,null,n(o,H)||null):ie.createElement("span",Object.assign({},H,{ref:i}),o);if(s){var at=s;return ie.createElement(at,Object.assign({},Te,{ref:i}))}return ie.createElement("input",Object.assign({},Te,{ref:i}))}function Oe(e,a){var r=a.decimalScale,s=a.fixedDecimalScale,n=a.prefix;n===void 0&&(n="");var i=a.suffix;i===void 0&&(i="");var m=a.allowNegative,p=a.thousandsGroupStyle;if(p===void 0&&(p="thousand"),e===""||e==="-")return e;var S=be(a),C=S.thousandSeparator,D=S.decimalSeparator,j=r!==0&&e.indexOf(".")!==-1||r&&s,h=De(e,m),g=h.beforeDecimal,c=h.afterDecimal,A=h.addNegation;return r!==void 0&&(c=Ke(c,r,!!s)),C&&(g=Dt(g,C,p)),n&&(g=n+g),i&&(c=c+i),A&&(g="-"+g),e=g+(j&&D||"")+c,e}function be(e){var a=e.decimalSeparator;a===void 0&&(a=".");var r=e.thousandSeparator,s=e.allowedDecimalSeparators;return r===!0&&(r=","),s||(s=[a,"."]),{decimalSeparator:a,thousandSeparator:r,allowedDecimalSeparators:s}}function kt(e,a){e===void 0&&(e="");var r=new RegExp("(-)"),s=new RegExp("(-)(.)*(-)"),n=r.test(e),i=s.test(e);return e=e.replace(/-/g,""),n&&!i&&a&&(e="-"+e),e}function Lt(e,a){return new RegExp("(^-)|[0-9]|"+He(e),"g")}function Gt(e,a,r){return e===""?!0:!(a!=null&&a.match(/\d/))&&!(r!=null&&r.match(/\d/))&&typeof e=="string"&&!isNaN(Number(e))}function $t(e,a,r){var s;a===void 0&&(a=Ot(e));var n=r.allowNegative,i=r.prefix;i===void 0&&(i="");var m=r.suffix;m===void 0&&(m="");var p=r.decimalScale,S=a.from,C=a.to,D=C.start,j=C.end,h=be(r),g=h.allowedDecimalSeparators,c=h.decimalSeparator,A=e[j]===c;if(ge(e)&&(e===i||e===m)&&a.lastValue==="")return e;if(j-D===1&&g.indexOf(e[D])!==-1){var T=p===0?"":c;e=e.substring(0,D)+T+e.substring(D+1,e.length)}var y=function(b,O,M){var k=!1,B=!1;i.startsWith("-")?k=!1:b.startsWith("--")?(k=!1,B=!0):m.startsWith("-")&&b.length===m.length?k=!1:b[0]==="-"&&(k=!0);var G=k?1:0;return B&&(G=2),G&&(b=b.substring(G),O-=G,M-=G),{value:b,start:O,end:M,hasNegation:k}},P=y(e,D,j),R=P.hasNegation;s=P,e=s.value,D=s.start,j=s.end;var $=y(a.lastValue,S.start,S.end),H=$.start,q=$.end,x=$.value,o=e.substring(D,j);e.length&&x.length&&(H>x.length-m.length||q<i.length)&&!(o&&m.startsWith(o))&&(e=x);var v=0;e.startsWith(i)?v+=i.length:D<i.length&&(v=D),e=e.substring(v),j-=v;var d=e.length,f=e.length-m.length;e.endsWith(m)?d=f:(j>f||j>e.length-m.length)&&(d=j),e=e.substring(0,d),e=kt(R?"-"+e:e,n),e=(e.match(Lt(c))||[]).join("");var F=e.indexOf(c);e=e.replace(new RegExp(He(c),"g"),function(b,O){return O===F?".":""});var L=De(e,n),Q=L.beforeDecimal,Z=L.afterDecimal,w=L.addNegation;return C.end-C.start<S.end-S.start&&Q===""&&A&&!parseFloat(Z)&&(e=w?"-":""),e}function Ht(e,a){var r=a.prefix;r===void 0&&(r="");var s=a.suffix;s===void 0&&(s="");var n=Array.from({length:e.length+1}).map(function(){return!0}),i=e[0]==="-";n.fill(!1,0,r.length+(i?1:0));var m=e.length;return n.fill(!1,m-s.length+1,m+1),n}function Kt(e){var a=be(e),r=a.thousandSeparator,s=a.decimalSeparator,n=e.prefix;n===void 0&&(n="");var i=e.allowNegative;if(i===void 0&&(i=!0),r===s)throw new Error(`
        Decimal separator can't be same as thousand separator.
        thousandSeparator: `+r+` (thousandSeparator = {true} is same as thousandSeparator = ",")
        decimalSeparator: `+s+` (default value for decimalSeparator is .)
     `);return n.startsWith("-")&&i&&(console.error(`
      Prefix can't start with '-' when allowNegative is true.
      prefix: `+n+`
      allowNegative: `+i+`
    `),i=!1),Object.assign(Object.assign({},e),{allowNegative:i})}function Ut(e){e=Kt(e),e.decimalSeparator,e.allowedDecimalSeparators,e.thousandsGroupStyle;var a=e.suffix,r=e.allowNegative,s=e.allowLeadingZeros,n=e.onKeyDown;n===void 0&&(n=te);var i=e.onBlur;i===void 0&&(i=te);var m=e.thousandSeparator,p=e.decimalScale,S=e.fixedDecimalScale,C=e.prefix;C===void 0&&(C="");var D=e.defaultValue,j=e.value,h=e.valueIsNumericString,g=e.onValueChange,c=Ge(e,["decimalSeparator","allowedDecimalSeparators","thousandsGroupStyle","suffix","allowNegative","allowLeadingZeros","onKeyDown","onBlur","thousandSeparator","decimalScale","fixedDecimalScale","prefix","defaultValue","value","valueIsNumericString","onValueChange"]),A=be(e),T=A.decimalSeparator,y=A.allowedDecimalSeparators,P=function(w){return Oe(w,e)},R=function(w,b){return $t(w,b,e)},$=oe(j)?D:j,H=h??Gt($,C,a);oe(j)?oe(D)||(H=H||typeof D=="number"):H=H||typeof j=="number";var q=function(w){return $e(w)?w:(typeof w=="number"&&(w=Ue(w)),H&&typeof p=="number"?Ae(w,p,!!S):w)},x=ze(q(j),q(D),!!H,P,R,g),o=x[0],v=o.numAsString,d=o.formattedValue,f=x[1],F=function(w){var b=w.target,O=w.key,M=b.selectionStart,k=b.selectionEnd,B=b.value;if(B===void 0&&(B=""),(O==="Backspace"||O==="Delete")&&k<C.length){w.preventDefault();return}if(M!==k){n(w);return}O==="Backspace"&&B[0]==="-"&&M===C.length+1&&r&&re(b,1),p&&S&&(O==="Backspace"&&B[M-1]===T?(re(b,M-1),w.preventDefault()):O==="Delete"&&B[M]===T&&w.preventDefault()),y!=null&&y.includes(O)&&B[M]===T&&re(b,M+1);var G=m===!0?",":m;O==="Backspace"&&B[M-1]===G&&re(b,M-1),O==="Delete"&&B[M]===G&&re(b,M+1),n(w)},L=function(w){var b=v;if(b.match(/\d/g)||(b=""),s||(b=Vt(b)),S&&p&&(b=Ae(b,p,S)),b!==v){var O=Oe(b,e);f({formattedValue:O,value:b,floatValue:parseFloat(b)},{event:w,source:ve.event})}i(w)},Q=function(w){return w===T?!0:ge(w)},Z=function(w){var b=w.currentValue,O=w.lastValue,M=w.formattedValue,k=w.currentValueIndex,B=w.formattedValueIndex,G=b[k],ne=M[B],je=We(O,b),le=je.to,xe=function(Ne){return R(Ne).indexOf(".")+C.length};return j===0&&S&&p&&b[le.start]===T&&xe(b)<k&&xe(M)>B?!1:k>=le.start&&k<le.end&&y&&y.includes(G)&&ne===T?!0:G===ne};return Object.assign(Object.assign({},c),{value:d,valueIsNumericString:!1,isValidInputCharacter:Q,isCharacterSame:Z,onValueChange:f,format:P,removeFormatting:R,getCaretBoundary:function(w){return Ht(w,e)},onKeyDown:F,onBlur:L})}function qe(e){var a=Ut(e);return ie.createElement(Mt,Object.assign({},a))}const Wt=({isDialogOpen:e,setIsDialogOpen:a,rows:r,setRows:s,selectedMembers:n,setSelectedMembers:i,members:m,errors:p,handleSubmit:S,loading:C,isAddDisabled:D})=>{const j=(x,o)=>{i(v=>({...v,[x]:o}))},h=(x,o)=>{const v=[...r];v[x].type=o,s(v)},g=(x,o)=>{const v=[...r];v[x].paymentMethod=o,s(v)},c=(x,o)=>{const v=[...r];v[x].amount=o,s(v)},A=(x,o)=>{const v=[...r];v[x].notes=o,s(v)},T=(x,o)=>{const v=[...r];v[x].date_created=o,s(v)},y=()=>new Date().toISOString().split("T")[0],P=()=>{s(x=>[...x,{type:"Tithes and Offering",paymentMethod:"Cash",amount:"",notes:"",date_created:y()}])},R=x=>{s(o=>o.filter((v,d)=>d!==x)),i(o=>{const v={...o};return delete v[x],v})},$=x=>Object.values(n).includes(x),H=()=>{const x=y(),o=r.map(v=>({member_id:null,type:v.type,amount:v.amount,payment_method:v.paymentMethod,date_created:v.date_created||x,notes:v.notes}));console.log("Submitting data:",o),S({tithes:o})},q=V.useMemo(()=>r.reduce((x,o)=>x+parseFloat(o.amount||"0"),0).toFixed(2),[r]);return t.jsx(_e,{open:e,onOpenChange:a,children:t.jsxs(Be,{className:"overflow-auto h-screen w-[98%] max-w-6xl mx-auto backdrop-blur-sm",children:[t.jsxs(Re,{className:"text-start",children:[t.jsx(Pe,{children:"Add Tithes & Offering"}),t.jsx(Me,{children:r.map((x,o)=>{var v,d;return t.jsxs("div",{className:"mt-5 mb-5 p-7 border border-b-4 border-primary rounded-lg flex flex-wrap gap-3 relative",children:[t.jsxs("div",{className:"flex-1 min-w-[200px]",children:[t.jsx(z,{htmlFor:"date_created",children:"Date Created"}),t.jsx(me,{type:"date",value:x.date_created||y(),onChange:f=>T(o,f.target.value)})]}),t.jsxs("div",{className:"flex-1 min-w-[200px]",children:[t.jsxs(z,{htmlFor:"member",children:["Member ",t.jsx("span",{className:"text-gray-500 text-[11px]",children:"(If no name, it's okay to leave it blank)"})]}),t.jsxs(ce,{value:n[o]||"",onValueChange:f=>j(o,f),children:[t.jsx(de,{children:t.jsx(ue,{placeholder:"Select a member",defaultValue:n[o]?"":"No name"})}),t.jsx(fe,{className:"overflow-auto max-h-[200px]",children:m.filter(f=>!$(f.id)||n[o]===f.id).map(f=>t.jsx(K,{value:f.id,className:"cursor-pointer hover:bg-gray-200",children:f.name},f.id))})]}),((v=p[o])==null?void 0:v.member)&&t.jsx("span",{className:"text-red-500 text-xs",children:p[o].member})]}),t.jsxs("div",{className:"flex-1 min-w-[200px]",children:[t.jsx(z,{htmlFor:"type",children:"Type:"}),t.jsxs(ce,{value:x.type,onValueChange:f=>h(o,f),children:[t.jsx(de,{children:t.jsx(ue,{placeholder:"Select a type"})}),t.jsxs(fe,{children:[t.jsx(K,{value:"Tithes and Offering",className:"cursor-pointer hover:bg-gray-200",children:"Tithes and Offering"}),t.jsx(K,{value:"Help fund",className:"cursor-pointer hover:bg-gray-200",children:"Help Fund"}),t.jsx(K,{value:"Solomon Pledge",className:"cursor-pointer hover:bg-gray-200",children:"Solomon Pledge"}),t.jsx(K,{value:"Others",className:"cursor-pointer hover:bg-gray-200",children:"Others..."})]})]})]}),t.jsxs("div",{className:"flex-1 min-w-[200px]",children:[t.jsxs(z,{htmlFor:"amount",children:["Amount (PHP) ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(qe,{thousandSeparator:!0,prefix:"₱ ",decimalScale:2,fixedDecimalScale:!0,allowNegative:!1,value:x.amount,onValueChange:f=>{const{value:F}=f;c(o,F)},className:"flex h-9 w-full rounded-md border border-primary bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",placeholder:"0.00"}),((d=p[o])==null?void 0:d.amount)&&t.jsx("span",{className:"text-red-500 text-xs",children:p[o].amount})]}),t.jsxs("div",{className:"flex-1 min-w-[200px]",children:[t.jsx(z,{htmlFor:"payment",children:"Payment Method"}),t.jsxs(ce,{value:x.paymentMethod,onValueChange:f=>g(o,f),children:[t.jsx(de,{children:t.jsx(ue,{placeholder:"Select a payment method"})}),t.jsxs(fe,{children:[t.jsx(K,{value:"Cash",className:"cursor-pointer hover:bg-gray-200",children:"Cash"}),t.jsx(K,{value:"Gcash",className:"cursor-pointer hover:bg-gray-200",children:"Gcash"}),t.jsx(K,{value:"Bank transfer",className:"cursor-pointer hover:bg-gray-200",children:"Bank Transfer"}),t.jsx(K,{value:"Others",className:"cursor-pointer hover:bg-gray-200",children:"Others..."})]})]})]}),t.jsxs("div",{className:"flex-1 min-w-[200px]",children:[t.jsx(z,{htmlFor:"notes",children:"Notes (Optional)"}),t.jsx(me,{placeholder:"Type your notes here...",value:x.notes,onChange:f=>A(o,f.target.value)})]}),o>0&&t.jsx(ae,{type:"button",className:"bg-red-500 hover:bg-red-400 h-8 w-8 m-2 rounded-full text-white text-sm absolute top-0 right-0",onClick:()=>R(o),children:t.jsx(he,{icon:rt})})]},o)})}),t.jsx("div",{className:"pb-10 flex justify-end items-center",children:t.jsxs(ae,{className:"bg-blue-500 hover:bg-blue-400 ",onClick:P,disabled:D,children:[t.jsx(he,{icon:Ee,className:"mr-2"})," Add Tithers"]})})]}),t.jsx(ke,{children:t.jsxs("div",{className:"flex items-center justify-between gap-2",children:[t.jsxs("div",{children:["Total Amount: ",t.jsxs("span",{className:"font-bold",children:["₱ ",q]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(gt,{asChild:!0,children:t.jsx(ae,{type:"button",className:"bg-red-500 hover:bg-red-400",disabled:C,children:"Cancel"})}),t.jsx(ae,{type:"submit",className:"bg-blue-500 hover:bg-blue-400",onClick:H,disabled:C,children:C?t.jsxs(t.Fragment,{children:[t.jsx("span",{children:"Submitting..."}),t.jsx("span",{className:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4 ml-2"})]}):t.jsx(t.Fragment,{children:"Submit"})})]})]})})]})})},Ze=V.forwardRef(({className:e,...a},r)=>t.jsx("textarea",{className:nt("flex min-h-[60px] w-full rounded-md border border-primary bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...a}));Ze.displayName="Textarea";function zt({tithe:e,editingTitheId:a,setEditingTitheId:r,handleEditTithe:s,index:n,setTithes:i}){var j;const m=new Date(e.created_at),p=Nt(m),[S,C]=V.useState({}),D=()=>{const h={};(!e.amount||parseFloat(e.amount)===0)&&(h.amount="Amount must be greater than zero."),e.type||(h.type="Type is required."),e.payment_method||(h.payment_method="Payment method is required."),C(h),Object.keys(h).length===0&&s(e)};return t.jsxs(_e,{open:a===e.id,onOpenChange:h=>{!h&&(e.amount===""||parseFloat(e.amount)===0)||r(h?e.id:null)},children:[t.jsx(xt,{asChild:!0,children:t.jsx(ae,{className:`text-white w-7 h-7 rounded-md ${p?"bg-green-500 hover:bg-green-400":""}`,disabled:!p,children:t.jsx(he,{icon:st})})}),t.jsxs(Be,{children:[t.jsxs(Re,{className:"text-start",children:[t.jsx(Pe,{children:"Edit tithes"}),t.jsxs(Me,{children:["Make changes to your tithes here. Click save when you're done.",t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(z,{htmlFor:"name",className:"text-start",children:"Fullname"}),t.jsx(me,{value:((j=e.member)==null?void 0:j.name)||"No name",readOnly:!0,className:"col-span-3 cursor-not-allowed"})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(z,{htmlFor:"date_created",className:"text-start",children:"Date created"}),t.jsx(me,{value:e.date_created,type:"date",onChange:h=>i(g=>{const c=[...g];return c[n].date_created=h.target.value,c}),className:"col-span-3"})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(z,{htmlFor:"amount",className:"text-start",children:"Amount"}),t.jsx(qe,{thousandSeparator:!0,prefix:"₱ ",decimalScale:2,fixedDecimalScale:!0,allowNegative:!1,value:e.amount,onValueChange:h=>i(g=>{const c=[...g];return c[n].amount=h.value,c}),className:"flex h-9 w-full col-span-3 rounded-md border border-primary bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",placeholder:"0.00"}),S.amount&&t.jsx("span",{className:"text-red-500 text-xs col-span-3",children:S.amount})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(z,{htmlFor:"type",className:"text-start",children:"Type"}),t.jsxs(ce,{value:e.type,onValueChange:h=>i(g=>{const c=[...g];return c[n].type=h,c}),children:[t.jsx(de,{className:"col-span-3",children:t.jsx(ue,{placeholder:"Select a type"})}),t.jsxs(fe,{children:[t.jsx(K,{value:"Tithes and Offering",children:"Tithes and Offering"}),t.jsx(K,{value:"Help fund",children:"Help fund"}),t.jsx(K,{value:"Solomon Pledge",children:"Solomon Pledge"})]})]}),S.type&&t.jsx("span",{className:"text-red-500 text-xs col-span-3",children:S.type})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(z,{htmlFor:"paymentMethod",className:"text-start",children:"Payment method"}),t.jsxs(ce,{value:e.payment_method,onValueChange:h=>i(g=>{const c=[...g];return c[n].payment_method=h,c}),children:[t.jsx(de,{className:"col-span-3",children:t.jsx(ue,{placeholder:"Select a payment method"})}),t.jsxs(fe,{children:[t.jsx(K,{value:"Cash",children:"Cash"}),t.jsx(K,{value:"Gcash",children:"Gcash"}),t.jsx(K,{value:"Bank transfer",children:"Bank transfer"}),t.jsx(K,{value:"Others",children:"Others"})]})]}),S.payment_method&&t.jsx("span",{className:"text-red-500 text-xs col-span-3",children:S.payment_method})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(z,{htmlFor:"notes",className:"text-start",children:"Notes"}),t.jsx(Ze,{value:e.notes,onChange:h=>i(g=>{const c=[...g];return c[n].notes=h.target.value,c}),className:"col-span-3",placeholder:"Add notes"})]})]})]})]}),t.jsx(ke,{children:t.jsx(ae,{type:"button",onClick:D,children:"Save changes"})})]})]})}function na(){const[e,a]=V.useState({}),[r,s]=V.useState([{type:"Tithes and Offering",paymentMethod:"Cash",amount:"",notes:""}]),[n,i]=V.useState([]),[m,p]=V.useState([]),[S,C]=V.useState(!1),[D,j]=V.useState(!1),[h,g]=V.useState(!1),[c,A]=V.useState({}),[T,y]=V.useState(""),[P,R]=V.useState(null);V.useEffect(()=>{$()},[]);const $=async()=>{try{const d=await ye.get("tithes",{headers:{"Content-Type":"application/json"}});i(d.data.listOfMembers),p(d.data.tithes)}catch(d){console.error("Error fetching members:",d)}},H=()=>{const d={};return r.forEach((f,F)=>{(!f.amount||parseFloat(f.amount)<=0)&&(d[F]={...d[F],amount:"Amount must be greater than 0"})}),A(d),Object.keys(d).length===0},q=async()=>{if(D||!H())return;j(!0),g(!0);const d=r.map((f,F)=>({member_id:e[F]||null,type:f.type,amount:parseFloat(f.amount),payment_method:f.paymentMethod,notes:f.notes}));try{const f=await ye.post("tithes",{tithes:d},{headers:{"Content-Type":"application/json"}});s([{type:"Tithes and Offering",paymentMethod:"Cash",amount:"",notes:""}]),a({}),C(!1),$();const F=f.data.message,L=F.includes("Note: Some members already had tithes recorded today.");se.fire({icon:L?"warning":"success",title:L?"Partial Success":"Success",text:F,timer:3e3,showConfirmButton:!1,timerProgressBar:!0})}catch(f){console.error("Error submitting tithes:",f)}finally{j(!1),g(!1)}},x=async d=>{try{const f=await ye.put(`tithes/${d.id}`,d,{headers:{"Content-Type":"application/json"}});$(),R(null);const F=f.data.message,L=F.includes("Note: Some members already had tithes recorded today.");se.fire({icon:L?"warning":"success",title:L?"Partial Success":"Success",text:F,timer:2e3,showConfirmButton:!1}),p(Q=>Q.map(Z=>Z.id===d.id?f.data.tithes:Z))}catch(f){console.error("Error updating tithes:",f),se.fire({icon:"error",title:"Error",text:"Failed to update tithes. Please try again."})}},o=m.filter(d=>{var f;return(((f=d.member)==null?void 0:f.name)||"").toLowerCase().includes(T.toLowerCase())||d.type.toLowerCase().includes(T.toLowerCase())||d.payment_method.toLowerCase().includes(T.toLowerCase())||(d.notes||"").toLowerCase().includes(T.toLowerCase())}),v=V.useMemo(()=>o.reduce((d,f)=>d+parseFloat(f.amount||"0"),0).toFixed(2),[o]);return t.jsxs("div",{className:"ml-56 mx-auto md:ml-0 md:w-full mt-3",children:[t.jsx("div",{className:"grid grid-cols-3 gap-4",children:t.jsx("div",{className:"col-span-3",children:t.jsx("div",{className:"rounded-md min-h-80 pl-2 md:pl-0",children:t.jsxs(dt,{children:[t.jsxs("div",{className:"py-2 flex flex-row justify-between",children:[t.jsx(ut,{className:"text-lg md:text-base md:hidden",children:"Tithes today"}),t.jsx("div",{className:"grid md:justify-end md:gap-2",children:t.jsx(me,{type:"text",placeholder:"Search by name, type, payment method, or notes",className:"w-52 placeholder-small md:w-[95%]",value:T,onChange:d=>y(d.target.value)})})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs(ft,{className:"w-full",children:[t.jsx(mt,{children:t.jsxs(pe,{children:[t.jsx(J,{className:"text-center md:text-xs",children:"#"}),t.jsx(J,{className:"text-center md:text-xs",children:"Photo"}),t.jsx(J,{className:"md:text-xs",children:"Full Name"}),t.jsx(J,{className:"md:text-xs",children:"Amount"}),t.jsx(J,{className:"md:text-xs",children:"Type"}),t.jsx(J,{className:"md:text-xs",children:"Payment Method"}),t.jsx(J,{className:"md:text-xs",children:"Date Giving"}),t.jsx(J,{className:"md:text-xs",children:"Notes"}),t.jsx(J,{className:"text-right md:text-xs",children:"Action"})]})}),t.jsxs(ht,{children:[o.length===0&&t.jsx(pe,{children:t.jsx(W,{colSpan:9,className:"text-center",children:"No tithes found."})}),o.map((d,f)=>{var F,L;return t.jsxs(pe,{children:[t.jsx(W,{className:"md:text-xs",children:f+1}),t.jsx(W,{className:"flex justify-center md:justify-center item-center md:h-24 ",children:(F=d.member)!=null&&F.photo?t.jsx("img",{src:`https://jamctagoloan.xyz/${d==null?void 0:d.member.photo}`,alt:d.member.name,className:"rounded-full h-10 w-10"}):t.jsxs(ot,{children:[t.jsx(lt,{src:"https://github.com/shadcn.png"}),t.jsx(ct,{children:"CN"})]})}),t.jsx(W,{className:"md:text-xs",children:((L=d.member)==null?void 0:L.name)||"No Name"}),t.jsx(W,{className:"md:text-xs",children:d.amount.toLocaleString("en-US",{style:"currency",currency:"PHP"})}),t.jsx(W,{className:"md:text-xs",children:d.type}),t.jsxs(W,{className:"md:text-xs",children:[d.payment_method==="Cash"&&t.jsx("span",{className:"inline-flex items-center rounded-md bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-green-600/20 ring-inset",children:"Cash"}),d.payment_method==="Gcash"&&t.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-blue-700/10 ring-inset",children:"Gcash"}),d.payment_method==="Bank transfer"&&t.jsx("span",{className:"inline-flex items-center rounded-md bg-purple-50 px-2 py-1 text-xs font-medium text-purple-700 ring-1 ring-purple-700/10 ring-inset",children:"Bank transfer"}),d.payment_method==="Others"&&t.jsx("span",{className:"inline-flex items-center rounded-md bg-[#1f2937] px-2 py-1 text-xs font-medium text-light",children:"Others"})]}),t.jsx(W,{className:"md:text-xs",children:yt(new Date(d.date_created),"MMMM dd, yyyy")}),t.jsx(W,{className:"md:text-xs",children:d.notes||"None"}),t.jsx(W,{className:"text-right",children:t.jsxs("div",{className:"flex justify-end md:flex-col md:gap-3 items-center gap-1",children:[t.jsx(zt,{tithe:d,editingTitheId:P,setEditingTitheId:R,handleEditTithe:x,index:f,setTithes:p}),t.jsx(ae,{variant:"destructive",size:"icon",onClick:async()=>{if((await se.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",confirmButtonColor:"#ef4444",cancelButtonText:"No, cancel!"})).isConfirmed)try{await ye.delete(`tithes/${d.id}`),$(),se.fire({icon:"success",title:"Deleted!",text:"The tithes has been deleted successfully.",timer:2e3,showConfirmButton:!1,timerProgressBar:!0})}catch(Z){console.error("Error deleting tithes:",Z),se.fire("Error!","Failed to delete tithes. Please try again.","error")}},className:"h-8 w-8 rounded-md hover:bg-red-500 hover:text-white focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:t.jsx(he,{icon:it})})]})})]},d.id)})]}),t.jsx(vt,{children:t.jsxs(pe,{children:[t.jsx(W,{colSpan:3,className:"text-right text-xl font-bold",children:"Total Amount:"}),t.jsx(W,{className:"font-bold text-xl",children:v.toLocaleString("en-US",{style:"currency",currency:"PHP"})}),t.jsx(W,{colSpan:5})]})})]})})]})})})}),t.jsx(ae,{onClick:()=>C(!0),className:"fixed bottom-20 right-4 w-12 h-12 rounded-full bg-primary text-white shadow-lg flex items-center justify-center",children:t.jsx(he,{icon:Ee})}),t.jsx(Wt,{isDialogOpen:S,setIsDialogOpen:C,rows:r,setRows:s,selectedMembers:e,setSelectedMembers:a,members:n,errors:c,handleSubmit:q,loading:D,isAddDisabled:h})]})}export{na as default};
