import{r as c,j as e,I as g,B as i,F as x,s as R,E as D,w as T,R as B,t as y}from"./index-fFKw0hkJ.js";import{a as C}from"./axios-Irler4Yi.js";import{C as M,a as P,T as q,b as H,c as v,d as h,e as L,f as d}from"./card-Od8nzP5e.js";import{D as k,a as O,b as V,c as U,d as Y,e as z,f as G}from"./dialog-BwhdcBKL.js";import{S as J}from"./sweetalert2.esm.all-B0Dix5B2.js";import{f as K}from"./format-B3-TfKxp.js";import"./index-Bp9QbQD3.js";import"./index-xCDpoEAJ.js";const F=()=>{const o=new Date,f=o.getFullYear(),u=String(o.getMonth()+1).padStart(2,"0"),l=String(o.getDate()).padStart(2,"0");return`${f}-${u}-${l}`};function re(){const o=[{date_created:F(),title:"",amount:""}],[f,u]=c.useState(!1),[l,p]=c.useState(o),[N,w]=c.useState(!1),[E,I]=c.useState([]),[n,m]=c.useState([{title:"",amount:""}]),S=async()=>{try{const s=await C.get("tithes",{headers:{"Content-Type":"application/json"}});I(s.data.expenses),console.log("Expense:",s.data.expenses)}catch(s){console.error("Error fetching members:",s)}};c.useEffect(()=>{S()},[]);const A=()=>{p([...l,{date_created:F(),title:"",amount:""}]),m([...n,{title:"",amount:""}])},b=(s,t,a)=>{const j=[...l];j[s][t]=a,p(j);const r=[...n];t==="title"&&a.trim()===""?r[s].title="Title is required":r[s].title="",t==="amount"&&(a.trim()===""||isNaN(Number(a)))?r[s].amount="Valid amount is required":r[s].amount="",m(r)},$=s=>{const t=l.filter((j,r)=>r!==s),a=n.filter((j,r)=>r!==s);p(t),m(a)},_=async()=>{if(N)return;w(!0);const s=l.map(a=>({title:a.title.trim()===""?"Title is required":"",amount:a.amount.trim()===""||isNaN(Number(a.amount))?"Valid amount is required":""}));if(m(s),s.some(a=>a.title||a.amount)){w(!1);return}try{const a=await C.post("expenses",{expenses:l});p(o),m([{title:"",amount:""}]),u(!1),S(),J.fire({icon:"success",title:"Success",text:a.data.message,timer:2e3,showConfirmButton:!1,timerProgressBar:!0})}catch(a){console.error("Error processing expenses:",a)}finally{w(!1)}};return e.jsxs("div",{className:"ml-56 mx-auto md:ml-0 md:w-full mt-3",children:[e.jsx("div",{className:"grid grid-cols-3 gap-4",children:e.jsx("div",{className:"col-span-3",children:e.jsx("div",{className:"rounded-md min-h-80 pl-2 md:pl-0",children:e.jsxs(M,{children:[e.jsxs("div",{className:"py-2 flex flex-row justify-between",children:[e.jsx(P,{className:"text-lg md:text-base",children:"List of Expense"}),e.jsx(g,{type:"text",placeholder:"Search",className:"w-52"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(q,{className:"w-full",children:[e.jsx(H,{children:e.jsxs(v,{children:[e.jsx(h,{className:"text-center md:text-xs",children:"#"}),e.jsx(h,{className:"text-center md:text-xs",children:"Date created"}),e.jsx(h,{className:"text-center md:text-xs",children:"Title"}),e.jsx(h,{className:"md:text-xs",children:"Amount"}),e.jsx(h,{className:"md:text-xs",children:"Action"})]})}),e.jsxs(L,{children:[E.length===0&&e.jsx(v,{children:e.jsx(d,{colSpan:5,className:"text-center text-gray-500",children:"No Expense found"})}),E.map((s,t)=>e.jsxs(v,{children:[e.jsx(d,{className:"md:text-xs",children:t+1}),e.jsx(d,{className:"md:text-xs uppercase font-bold",children:K(new Date(s.date_created),"MMMM dd, yyyy")}),e.jsx(d,{className:"md:text-xs text-center uppercase font-bold",children:s.title}),e.jsx(d,{className:"md:text-xs font-bold",children:s.amount.toLocaleString("en-US",{style:"currency",currency:"PHP"})}),e.jsx(d,{className:"md:text-xs",children:e.jsxs("div",{className:"flex justify-end md:flex-col md:gap-3 items-center gap-1",children:[e.jsx(i,{className:"text-white w-7 h-7 bg-green-500 hover:bg-green-400 rounded-md",children:e.jsx(x,{icon:R})}),e.jsx(i,{className:"text-white bg-red-500 w-7 h-7 hover:bg-red-400 rounded-md",children:e.jsx(x,{icon:D})})]})})]},s.id))]})]})}),e.jsx("div",{className:"flex flex-row justify-end mt-5",children:e.jsx("div",{children:e.jsx("p",{className:"text-[#172554] text-base w-full font-bold",children:"Showing 1 to 10 entries"})})})]})})})}),e.jsxs(k,{open:f,onOpenChange:u,children:[e.jsx(O,{asChild:!0,children:e.jsx(i,{className:"fixed bottom-20 right-4 w-12 h-12 rounded-full bg-primary text-white shadow-lg flex items-center justify-center",children:e.jsx(x,{icon:T})})}),e.jsxs(V,{className:"overflow-auto max-w-[600px] max-h-[80vh] md:max-h-[90vh] md:max-w-[450px]",children:[e.jsx("div",{children:e.jsxs(U,{className:"text-start",children:[e.jsx(Y,{children:"Add Expense"}),e.jsxs(z,{children:["Add expense to the list.",e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-4",children:[l.map((s,t)=>e.jsxs(B.Fragment,{children:[e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(y,{htmlFor:`date-${t}`,children:"Date"}),e.jsx(g,{id:`date-${t}`,type:"date",value:s.date_created,onChange:a=>b(t,"date_created",a.target.value)})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(y,{htmlFor:`title-${t}`,children:"Title"}),e.jsx(g,{type:"text",placeholder:"Enter your title here",value:s.title,onChange:a=>b(t,"title",a.target.value)}),n[t].title&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n[t].title})]}),e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(y,{htmlFor:`amount-${t}`,children:"Amount"}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(g,{id:`amount-${t}`,type:"text",placeholder:"0.00",value:s.amount,onChange:a=>b(t,"amount",a.target.value)}),t>0&&e.jsx(i,{className:"bg-red-500 hover:bg-red-400 w-10",onClick:()=>$(t),children:e.jsx(x,{icon:D})})]}),n[t].amount&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:n[t].amount})]})]},t)),e.jsx("div",{className:"col-span-3 flex justify-start",children:e.jsxs(i,{className:"bg-blue-500 hover:bg-blue-400 w-32 h-7",onClick:A,children:[e.jsx(x,{icon:T}),"Add Expense"]})})]})]})]})}),e.jsx(G,{className:"flex flex-row justify-end",children:e.jsx(i,{className:"w-56",type:"button",onClick:_,disabled:N,children:N?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Submit..."}),e.jsx("span",{className:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4"})]}):e.jsx(e.Fragment,{children:"Submit"})})})]})]})]})}export{re as default};
