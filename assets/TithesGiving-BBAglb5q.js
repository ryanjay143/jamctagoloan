import{R as se,r as A,j as t,I as le,t as Q,B as te,F as ve,C as st,w as Fe,D as it,s as ot,E as lt}from"./index-Drk5BU69.js";import{A as ct,a as dt,b as ut}from"./avatar-BWruAuEn.js";import{j as ft,b as _e,c as ie,d as q,e as Be,f as U,k as mt,C as ht,a as vt,T as gt}from"./card-V3olZD_Z.js";import{a as be}from"./axios-1xl_CE3x.js";import{S as ne}from"./sweetalert2.esm.all-B0Dix5B2.js";import{D as Re,b as ke,c as Me,d as Pe,e as Le,f as Ge,g as xt,a as pt}from"./dialog-B56-8IkG.js";import{S as ue,a as fe,b as me,c as he,d as H}from"./select-Be_38L1A.js";import{c as $e,n as bt,s as Te,f as yt}from"./format-B3-TfKxp.js";import"./index-LHqQ0Xh3.js";import"./index-B5YzKGgF.js";function jt(e){return $e(e,Date.now())}function Nt(e,a,r){const[s,n]=bt(r==null?void 0:r.in,e,a);return+Te(s)==+Te(n)}function St(e,a){return Nt($e(e,e),jt(e))}function Ke(e,a){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&a.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(e);n<s.length;n++)a.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(r[s[n]]=e[s[n]]);return r}var ge;(function(e){e.event="event",e.props="prop"})(ge||(ge={}));function ee(){}function wt(e){var a,r=void 0;return function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return a&&s.length===a.length&&s.every(function(i,o){return i===a[o]})||(a=s,r=e.apply(void 0,s)),r}}function xe(e){return!!(e||"").match(/\d/)}function oe(e){return e==null}function Ct(e){return typeof e=="number"&&isNaN(e)}function He(e){return oe(e)||Ct(e)||typeof e=="number"&&!isFinite(e)}function Ue(e){return e.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")}function Dt(e){switch(e){case"lakh":return/(\d+?)(?=(\d\d)+(\d)(?!\d))(\.\d+)?/g;case"wan":return/(\d)(?=(\d{4})+(?!\d))/g;case"thousand":default:return/(\d)(?=(\d{3})+(?!\d))/g}}function Vt(e,a,r){var s=Dt(r),n=e.search(/[1-9]/);return n=n===-1?e.length:n,e.substring(0,n)+e.substring(n,e.length).replace(s,"$1"+a)}function Tt(e){var a=A.useRef(e);a.current=e;var r=A.useRef(function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return a.current.apply(a,s)});return r.current}function De(e,a){a===void 0&&(a=!0);var r=e[0]==="-",s=r&&a;e=e.replace("-","");var n=e.split("."),i=n[0],o=n[1]||"";return{beforeDecimal:i,afterDecimal:o,hasNegation:r,addNegation:s}}function It(e){if(!e)return e;var a=e[0]==="-";a&&(e=e.substring(1,e.length));var r=e.split("."),s=r[0].replace(/^0+/,"")||"0",n=r[1]||"";return(a?"-":"")+s+(n?"."+n:"")}function We(e,a,r){for(var s="",n=r?"0":"",i=0;i<=a-1;i++)s+=e[i]||n;return s}function Ie(e,a){return Array(a+1).join(e)}function qe(e){var a=e+"",r=a[0]==="-"?"-":"";r&&(a=a.substring(1));var s=a.split(/[eE]/g),n=s[0],i=s[1];if(i=Number(i),!i)return r+n;n=n.replace(".","");var o=1+i,m=n.length;return o<0?n="0."+Ie("0",Math.abs(o))+n:o>=m?n=n+Ie("0",o-m):n=(n.substring(0,o)||"0")+"."+n.substring(o),r+n}function Ae(e,a,r){if(["","-"].indexOf(e)!==-1)return e;var s=(e.indexOf(".")!==-1||r)&&a,n=De(e),i=n.beforeDecimal,o=n.afterDecimal,m=n.hasNegation,x=parseFloat("0."+(o||"0")),C=o.length<=a?"0."+o:x.toFixed(a),D=C.split("."),j=i;i&&Number(D[0])&&(j=i.split("").reverse().reduce(function(O,V,b){return O.length>b?(Number(O[0])+Number(V)).toString()+O.substring(1,O.length):V+O},D[0]));var h=We(D[1]||"",a,r),p=m?"-":"",u=s?".":"";return""+p+j+u+h}function ae(e,a){if(e.value=e.value,e!==null){if(e.createTextRange){var r=e.createTextRange();return r.move("character",a),r.select(),!0}return e.selectionStart||e.selectionStart===0?(e.focus(),e.setSelectionRange(a,a),!0):(e.focus(),!1)}}var Qe=wt(function(e,a){for(var r=0,s=0,n=e.length,i=a.length;e[r]===a[r]&&r<n;)r++;for(;e[n-1-s]===a[i-1-s]&&i-s>r&&n-s>r;)s++;return{from:{start:r,end:n-s},to:{start:r,end:i-s}}}),At=function(e,a){var r=Math.min(e.selectionStart,a);return{from:{start:r,end:e.selectionEnd},to:{start:r,end:a}}};function Ot(e,a,r){return Math.min(Math.max(e,a),r)}function Ce(e){return Math.max(e.selectionStart,e.selectionEnd)}function Et(){return typeof navigator<"u"&&!(navigator.platform&&/iPhone|iPod/.test(navigator.platform))}function Ft(e){return{from:{start:0,end:0},to:{start:0,end:e.length},lastValue:""}}function _t(e){var a=e.currentValue,r=e.formattedValue,s=e.currentValueIndex,n=e.formattedValueIndex;return a[s]===r[n]}function Bt(e,a,r,s,n,i,o){o===void 0&&(o=_t);var m=n.findIndex(function($){return $}),x=e.slice(0,m);!a&&!r.startsWith(x)&&(a=x,r=x+r,s=s+x.length);for(var C=r.length,D=e.length,j={},h=new Array(C),p=0;p<C;p++){h[p]=-1;for(var u=0,O=D;u<O;u++){var V=o({currentValue:r,lastValue:a,formattedValue:e,currentValueIndex:p,formattedValueIndex:u});if(V&&j[u]!==!0){h[p]=u,j[u]=!0;break}}}for(var b=s;b<C&&(h[b]===-1||!i(r[b]));)b++;var k=b===C||h[b]===-1?D:h[b];for(b=s-1;b>0&&h[b]===-1;)b--;var R=b===-1||h[b]===-1?0:h[b]+1;return R>k?k:s-R<k-s?R:k}function Oe(e,a,r,s){var n=e.length;if(a=Ot(a,0,n),s==="left"){for(;a>=0&&!r[a];)a--;a===-1&&(a=r.indexOf(!0))}else{for(;a<=n&&!r[a];)a++;a>n&&(a=r.lastIndexOf(!0))}return a===-1&&(a=n),a}function Rt(e){for(var a=Array.from({length:e.length+1}).map(function(){return!0}),r=0,s=a.length;r<s;r++)a[r]=!!(xe(e[r])||xe(e[r-1]));return a}function ze(e,a,r,s,n,i){i===void 0&&(i=ee);var o=Tt(function(u,O){var V,b;return He(u)?(b="",V=""):typeof u=="number"||O?(b=typeof u=="number"?qe(u):u,V=s(b)):(b=n(u,void 0),V=s(b)),{formattedValue:V,numAsString:b}}),m=A.useState(function(){return o(oe(e)?a:e,r)}),x=m[0],C=m[1],D=function(u,O){u.formattedValue!==x.formattedValue&&C({formattedValue:u.formattedValue,numAsString:u.value}),i(u,O)},j=e,h=r;oe(e)&&(j=x.numAsString,h=!0);var p=o(j,h);return A.useMemo(function(){C(p)},[p.formattedValue]),[x,D]}function kt(e){return e.replace(/[^0-9]/g,"")}function Mt(e){return e}function Pt(e){var a=e.type;a===void 0&&(a="text");var r=e.displayType;r===void 0&&(r="input");var s=e.customInput,n=e.renderText,i=e.getInputRef,o=e.format;o===void 0&&(o=Mt);var m=e.removeFormatting;m===void 0&&(m=kt);var x=e.defaultValue,C=e.valueIsNumericString,D=e.onValueChange,j=e.isAllowed,h=e.onChange;h===void 0&&(h=ee);var p=e.onKeyDown;p===void 0&&(p=ee);var u=e.onMouseUp;u===void 0&&(u=ee);var O=e.onFocus;O===void 0&&(O=ee);var V=e.onBlur;V===void 0&&(V=ee);var b=e.value,k=e.getCaretBoundary;k===void 0&&(k=Rt);var R=e.isValidInputCharacter;R===void 0&&(R=xe);var $=e.isCharacterSame,K=Ke(e,["type","displayType","customInput","renderText","getInputRef","format","removeFormatting","defaultValue","valueIsNumericString","onValueChange","isAllowed","onChange","onKeyDown","onMouseUp","onFocus","onBlur","value","getCaretBoundary","isValidInputCharacter","isCharacterSame"]),S=ze(b,x,!!C,o,m,D),g=S[0],d=g.formattedValue,l=g.numAsString,v=S[1],T=A.useRef(),L=A.useRef({formattedValue:d,numAsString:l}),z=function(c,f){L.current={formattedValue:c.formattedValue,numAsString:c.value},v(c,f)},Z=A.useState(!1),ce=Z[0],w=Z[1],y=A.useRef(null),E=A.useRef({setCaretTimeout:null,focusTimeout:null});A.useEffect(function(){return w(!0),function(){clearTimeout(E.current.setCaretTimeout),clearTimeout(E.current.focusTimeout)}},[]);var M=o,P=function(c,f){var N=parseFloat(f);return{formattedValue:c,value:f,floatValue:isNaN(N)?void 0:N}},B=function(c,f,N){c.selectionStart===0&&c.selectionEnd===c.value.length||(ae(c,f),E.current.setCaretTimeout=setTimeout(function(){c.value===N&&c.selectionStart!==f&&ae(c,f)},0))},G=function(c,f,N){return Oe(c,f,k(c),N)},re=function(c,f,N){var F=k(f),W=Bt(f,d,c,N,F,R,$);return W=Oe(f,W,F),W},je=function(c){var f=c.formattedValue;f===void 0&&(f="");var N=c.input,F=c.source,W=c.event,_=c.numAsString,I;if(N){var Y=c.inputValue||N.value,J=Ce(N);N.value=f,I=re(Y,f,J),I!==void 0&&B(N,I,f)}f!==d&&z(P(f,_),{event:W,source:F})};A.useEffect(function(){var c=L.current,f=c.formattedValue,N=c.numAsString;(d!==f||l!==N)&&z(P(d,l),{event:void 0,source:ge.props})},[d,l]);var de=y.current?Ce(y.current):void 0,pe=typeof window<"u"?A.useLayoutEffect:A.useEffect;pe(function(){var c=y.current;if(d!==L.current.formattedValue&&c){var f=re(L.current.formattedValue,d,de);c.value=d,B(c,f,d)}},[d]);var Ne=function(c,f,N){var F=f.target,W=T.current?At(T.current,F.selectionEnd):Qe(d,c),_=Object.assign(Object.assign({},W),{lastValue:d}),I=m(c,_),Y=M(I);if(I=m(Y,void 0),j&&!j(P(Y,I))){var J=f.target,X=Ce(J),we=re(c,d,X);return J.value=d,B(J,we,d),!1}return je({formattedValue:Y,numAsString:I,inputValue:c,event:f,source:N,input:f.target}),!0},Se=function(c,f){f===void 0&&(f=0);var N=c.selectionStart,F=c.selectionEnd;T.current={selectionStart:N,selectionEnd:F+f}},Je=function(c){var f=c.target,N=f.value,F=Ne(N,c,ge.event);F&&h(c),T.current=void 0},Xe=function(c){var f=c.target,N=c.key,F=f.selectionStart,W=f.selectionEnd,_=f.value;_===void 0&&(_="");var I;N==="ArrowLeft"||N==="Backspace"?I=Math.max(F-1,0):N==="ArrowRight"?I=Math.min(F+1,_.length):N==="Delete"&&(I=F);var Y=0;N==="Delete"&&F===W&&(Y=1);var J=N==="ArrowLeft"||N==="ArrowRight";if(I===void 0||F!==W&&!J){p(c),Se(f,Y);return}var X=I;if(J){var we=N==="ArrowLeft"?"left":"right";X=G(_,I,we),X!==I&&c.preventDefault()}else N==="Delete"&&!R(_[I])?X=G(_,I,"right"):N==="Backspace"&&!R(_[I])&&(X=G(_,I,"left"));X!==I&&B(f,X,_),p(c),Se(f,Y)},et=function(c){var f=c.target,N=function(){var F=f.selectionStart,W=f.selectionEnd,_=f.value;if(_===void 0&&(_=""),F===W){var I=G(_,F);I!==F&&B(f,I,_)}};N(),requestAnimationFrame(function(){N()}),u(c),Se(f)},tt=function(c){c.persist&&c.persist();var f=c.target,N=c.currentTarget;y.current=f,E.current.focusTimeout=setTimeout(function(){var F=f.selectionStart,W=f.selectionEnd,_=f.value;_===void 0&&(_="");var I=G(_,F);I!==F&&!(F===0&&W===_.length)&&B(f,I,_),O(Object.assign(Object.assign({},c),{currentTarget:N}))},0)},at=function(c){y.current=null,clearTimeout(E.current.focusTimeout),clearTimeout(E.current.setCaretTimeout),V(c)},rt=ce&&Et()?"numeric":void 0,Ve=Object.assign({inputMode:rt},K,{type:a,value:d,onChange:Je,onKeyDown:Xe,onMouseUp:et,onFocus:tt,onBlur:at});if(r==="text")return n?se.createElement(se.Fragment,null,n(d,K)||null):se.createElement("span",Object.assign({},K,{ref:i}),d);if(s){var nt=s;return se.createElement(nt,Object.assign({},Ve,{ref:i}))}return se.createElement("input",Object.assign({},Ve,{ref:i}))}function Ee(e,a){var r=a.decimalScale,s=a.fixedDecimalScale,n=a.prefix;n===void 0&&(n="");var i=a.suffix;i===void 0&&(i="");var o=a.allowNegative,m=a.thousandsGroupStyle;if(m===void 0&&(m="thousand"),e===""||e==="-")return e;var x=ye(a),C=x.thousandSeparator,D=x.decimalSeparator,j=r!==0&&e.indexOf(".")!==-1||r&&s,h=De(e,o),p=h.beforeDecimal,u=h.afterDecimal,O=h.addNegation;return r!==void 0&&(u=We(u,r,!!s)),C&&(p=Vt(p,C,m)),n&&(p=n+p),i&&(u=u+i),O&&(p="-"+p),e=p+(j&&D||"")+u,e}function ye(e){var a=e.decimalSeparator;a===void 0&&(a=".");var r=e.thousandSeparator,s=e.allowedDecimalSeparators;return r===!0&&(r=","),s||(s=[a,"."]),{decimalSeparator:a,thousandSeparator:r,allowedDecimalSeparators:s}}function Lt(e,a){e===void 0&&(e="");var r=new RegExp("(-)"),s=new RegExp("(-)(.)*(-)"),n=r.test(e),i=s.test(e);return e=e.replace(/-/g,""),n&&!i&&a&&(e="-"+e),e}function Gt(e,a){return new RegExp("(^-)|[0-9]|"+Ue(e),"g")}function $t(e,a,r){return e===""?!0:!(a!=null&&a.match(/\d/))&&!(r!=null&&r.match(/\d/))&&typeof e=="string"&&!isNaN(Number(e))}function Kt(e,a,r){var s;a===void 0&&(a=Ft(e));var n=r.allowNegative,i=r.prefix;i===void 0&&(i="");var o=r.suffix;o===void 0&&(o="");var m=r.decimalScale,x=a.from,C=a.to,D=C.start,j=C.end,h=ye(r),p=h.allowedDecimalSeparators,u=h.decimalSeparator,O=e[j]===u;if(xe(e)&&(e===i||e===o)&&a.lastValue==="")return e;if(j-D===1&&p.indexOf(e[D])!==-1){var V=m===0?"":u;e=e.substring(0,D)+V+e.substring(D+1,e.length)}var b=function(y,E,M){var P=!1,B=!1;i.startsWith("-")?P=!1:y.startsWith("--")?(P=!1,B=!0):o.startsWith("-")&&y.length===o.length?P=!1:y[0]==="-"&&(P=!0);var G=P?1:0;return B&&(G=2),G&&(y=y.substring(G),E-=G,M-=G),{value:y,start:E,end:M,hasNegation:P}},k=b(e,D,j),R=k.hasNegation;s=k,e=s.value,D=s.start,j=s.end;var $=b(a.lastValue,x.start,x.end),K=$.start,S=$.end,g=$.value,d=e.substring(D,j);e.length&&g.length&&(K>g.length-o.length||S<i.length)&&!(d&&o.startsWith(d))&&(e=g);var l=0;e.startsWith(i)?l+=i.length:D<i.length&&(l=D),e=e.substring(l),j-=l;var v=e.length,T=e.length-o.length;e.endsWith(o)?v=T:(j>T||j>e.length-o.length)&&(v=j),e=e.substring(0,v),e=Lt(R?"-"+e:e,n),e=(e.match(Gt(u))||[]).join("");var L=e.indexOf(u);e=e.replace(new RegExp(Ue(u),"g"),function(y,E){return E===L?".":""});var z=De(e,n),Z=z.beforeDecimal,ce=z.afterDecimal,w=z.addNegation;return C.end-C.start<x.end-x.start&&Z===""&&O&&!parseFloat(ce)&&(e=w?"-":""),e}function Ht(e,a){var r=a.prefix;r===void 0&&(r="");var s=a.suffix;s===void 0&&(s="");var n=Array.from({length:e.length+1}).map(function(){return!0}),i=e[0]==="-";n.fill(!1,0,r.length+(i?1:0));var o=e.length;return n.fill(!1,o-s.length+1,o+1),n}function Ut(e){var a=ye(e),r=a.thousandSeparator,s=a.decimalSeparator,n=e.prefix;n===void 0&&(n="");var i=e.allowNegative;if(i===void 0&&(i=!0),r===s)throw new Error(`
        Decimal separator can't be same as thousand separator.
        thousandSeparator: `+r+` (thousandSeparator = {true} is same as thousandSeparator = ",")
        decimalSeparator: `+s+` (default value for decimalSeparator is .)
     `);return n.startsWith("-")&&i&&(console.error(`
      Prefix can't start with '-' when allowNegative is true.
      prefix: `+n+`
      allowNegative: `+i+`
    `),i=!1),Object.assign(Object.assign({},e),{allowNegative:i})}function Wt(e){e=Ut(e),e.decimalSeparator,e.allowedDecimalSeparators,e.thousandsGroupStyle;var a=e.suffix,r=e.allowNegative,s=e.allowLeadingZeros,n=e.onKeyDown;n===void 0&&(n=ee);var i=e.onBlur;i===void 0&&(i=ee);var o=e.thousandSeparator,m=e.decimalScale,x=e.fixedDecimalScale,C=e.prefix;C===void 0&&(C="");var D=e.defaultValue,j=e.value,h=e.valueIsNumericString,p=e.onValueChange,u=Ke(e,["decimalSeparator","allowedDecimalSeparators","thousandsGroupStyle","suffix","allowNegative","allowLeadingZeros","onKeyDown","onBlur","thousandSeparator","decimalScale","fixedDecimalScale","prefix","defaultValue","value","valueIsNumericString","onValueChange"]),O=ye(e),V=O.decimalSeparator,b=O.allowedDecimalSeparators,k=function(w){return Ee(w,e)},R=function(w,y){return Kt(w,y,e)},$=oe(j)?D:j,K=h??$t($,C,a);oe(j)?oe(D)||(K=K||typeof D=="number"):K=K||typeof j=="number";var S=function(w){return He(w)?w:(typeof w=="number"&&(w=qe(w)),K&&typeof m=="number"?Ae(w,m,!!x):w)},g=ze(S(j),S(D),!!K,k,R,p),d=g[0],l=d.numAsString,v=d.formattedValue,T=g[1],L=function(w){var y=w.target,E=w.key,M=y.selectionStart,P=y.selectionEnd,B=y.value;if(B===void 0&&(B=""),(E==="Backspace"||E==="Delete")&&P<C.length){w.preventDefault();return}if(M!==P){n(w);return}E==="Backspace"&&B[0]==="-"&&M===C.length+1&&r&&ae(y,1),m&&x&&(E==="Backspace"&&B[M-1]===V?(ae(y,M-1),w.preventDefault()):E==="Delete"&&B[M]===V&&w.preventDefault()),b!=null&&b.includes(E)&&B[M]===V&&ae(y,M+1);var G=o===!0?",":o;E==="Backspace"&&B[M-1]===G&&ae(y,M-1),E==="Delete"&&B[M]===G&&ae(y,M+1),n(w)},z=function(w){var y=l;if(y.match(/\d/g)||(y=""),s||(y=It(y)),x&&m&&(y=Ae(y,m,x)),y!==l){var E=Ee(y,e);T({formattedValue:E,value:y,floatValue:parseFloat(y)},{event:w,source:ge.event})}i(w)},Z=function(w){return w===V?!0:xe(w)},ce=function(w){var y=w.currentValue,E=w.lastValue,M=w.formattedValue,P=w.currentValueIndex,B=w.formattedValueIndex,G=y[P],re=M[B],je=Qe(E,y),de=je.to,pe=function(Ne){return R(Ne).indexOf(".")+C.length};return j===0&&x&&m&&y[de.start]===V&&pe(y)<P&&pe(M)>B?!1:P>=de.start&&P<de.end&&b&&b.includes(G)&&re===V?!0:G===re};return Object.assign(Object.assign({},u),{value:v,valueIsNumericString:!1,isValidInputCharacter:Z,isCharacterSame:ce,onValueChange:T,format:k,removeFormatting:R,getCaretBoundary:function(w){return Ht(w,e)},onKeyDown:L,onBlur:z})}function Ze(e){var a=Wt(e);return se.createElement(Pt,Object.assign({},a))}function qt(){const e=[1e3,500,200,100,50,20,10,5,1],[a,r]=A.useState(Array(e.length).fill(0)),s=(o,m)=>{const x=[...a];x[o]=parseInt(m)||0,r(x)},n=(o,m)=>o*m,i=a.reduce((o,m,x)=>o+n(e[x],m),0);return t.jsxs(ft,{children:[t.jsx(_e,{children:t.jsxs(ie,{children:[t.jsx(q,{className:"text-center border border-white",children:"Denomination"}),t.jsx(q,{className:"text-center border border-white",children:"Quantity"}),t.jsx(q,{className:"text-center border border-white",children:"Amount"})]})}),t.jsx(Be,{children:e.map((o,m)=>t.jsxs(ie,{children:[t.jsx(U,{className:"text-center font-bold text-base border border-primary","data-value":o,children:o}),t.jsx(U,{className:"text-center border border-primary",children:t.jsx("div",{className:"flex justify-center items-center",children:t.jsx(le,{type:"number",placeholder:"0",min:"0",className:"w-full max-w-52",value:a[m]===0?"":a[m],onChange:x=>s(m,x.target.value)})})}),t.jsx(U,{className:"text-center font-bold text-base border border-primary",children:n(o,a[m])})]},o))}),t.jsx(mt,{children:t.jsxs(ie,{children:[t.jsx(U,{className:"text-right font-bold text-base border border-primary",colSpan:2,children:"Total Amount (Cash)"}),t.jsx(U,{className:"text-center font-bold text-base border border-primary",children:i})]})})]})}const Qt=({isDialogOpen:e,setIsDialogOpen:a,rows:r,setRows:s,selectedMembers:n,setSelectedMembers:i,members:o,errors:m,handleSubmit:x,loading:C,isAddDisabled:D})=>{const j=(S,g)=>{i(d=>({...d,[S]:g}))},h=(S,g)=>{const d=[...r];d[S].type=g,s(d)},p=(S,g)=>{const d=[...r];d[S].paymentMethod=g,s(d)},u=(S,g)=>{const d=[...r];d[S].amount=g,s(d)},O=(S,g)=>{const d=[...r];d[S].notes=g,s(d)},V=(S,g)=>{const d=[...r];d[S].date_created=g,s(d)},b=()=>new Date().toISOString().split("T")[0],k=()=>{s(S=>[...S,{type:"Tithes and Offering",paymentMethod:"Cash",amount:"",notes:"",date_created:b()}])},R=S=>{s(g=>g.filter((d,l)=>l!==S)),i(g=>{const d={...g};return delete d[S],d})},$=S=>Object.values(n).includes(S),K=()=>{const S=b(),g=r.map((d,l)=>({member_id:n[l],type:d.type,amount:d.amount,payment_method:d.paymentMethod,date_created:d.date_created||S,notes:d.notes}));console.log("Submitting data:",g),x({tithes:g})};return t.jsx(Re,{open:e,onOpenChange:a,children:t.jsxs(ke,{className:"overflow-auto h-screen w-[98%] max-w-6xl mx-auto backdrop-blur-sm",children:[t.jsxs(Me,{className:"text-start",children:[t.jsx(Pe,{children:"Add Tithes & Offering"}),t.jsx(Le,{children:r.map((S,g)=>{var d,l;return t.jsxs("div",{className:"mt-5 mb-5 p-7 border border-b-4 border-primary rounded-lg flex flex-wrap gap-3 relative",children:[t.jsxs("div",{className:"flex-1 min-w-[200px]",children:[t.jsx(Q,{htmlFor:"date_created",children:"Date Created"}),t.jsx(le,{type:"date",value:S.date_created||b(),onChange:v=>V(g,v.target.value)})]}),t.jsxs("div",{className:"flex-1 min-w-[200px]",children:[t.jsxs(Q,{htmlFor:"member",children:["Member ",t.jsx("span",{className:"text-gray-500 text-[11px]",children:"(If no name, it's okay to leave it blank)"})]}),t.jsxs(ue,{value:n[g]||"",onValueChange:v=>j(g,v),children:[t.jsx(fe,{children:t.jsx(me,{placeholder:"Select a member",defaultValue:n[g]?"":"No name"})}),t.jsx(he,{className:"overflow-auto max-h-[200px]",children:o.filter(v=>!$(v.id)||n[g]===v.id).map(v=>t.jsx(H,{value:v.id,className:"cursor-pointer hover:bg-gray-200",children:v.name},v.id))})]}),((d=m[g])==null?void 0:d.member)&&t.jsx("span",{className:"text-red-500 text-xs",children:m[g].member})]}),t.jsxs("div",{className:"flex-1 min-w-[200px]",children:[t.jsx(Q,{htmlFor:"type",children:"Type:"}),t.jsxs(ue,{value:S.type,onValueChange:v=>h(g,v),children:[t.jsx(fe,{children:t.jsx(me,{placeholder:"Select a type"})}),t.jsxs(he,{children:[t.jsx(H,{value:"Tithes and Offering",className:"cursor-pointer hover:bg-gray-200",children:"Tithes and Offering"}),t.jsx(H,{value:"Help fund",className:"cursor-pointer hover:bg-gray-200",children:"Help Fund"}),t.jsx(H,{value:"Solomon Pledge",className:"cursor-pointer hover:bg-gray-200",children:"Solomon Pledge"}),t.jsx(H,{value:"Others",className:"cursor-pointer hover:bg-gray-200",children:"Others..."})]})]})]}),t.jsxs("div",{className:"flex-1 min-w-[200px]",children:[t.jsxs(Q,{htmlFor:"amount",children:["Amount (PHP) ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Ze,{thousandSeparator:!0,prefix:"₱ ",decimalScale:2,fixedDecimalScale:!0,allowNegative:!1,value:S.amount,onValueChange:v=>{const{value:T}=v;u(g,T)},className:"flex h-9 w-full rounded-md border border-primary bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",placeholder:"0.00"}),((l=m[g])==null?void 0:l.amount)&&t.jsx("span",{className:"text-red-500 text-xs",children:m[g].amount})]}),t.jsxs("div",{className:"flex-1 min-w-[200px]",children:[t.jsx(Q,{htmlFor:"payment",children:"Payment Method"}),t.jsxs(ue,{value:S.paymentMethod,onValueChange:v=>p(g,v),children:[t.jsx(fe,{children:t.jsx(me,{placeholder:"Select a payment method"})}),t.jsxs(he,{children:[t.jsx(H,{value:"Cash",className:"cursor-pointer hover:bg-gray-200",children:"Cash"}),t.jsx(H,{value:"Gcash",className:"cursor-pointer hover:bg-gray-200",children:"Gcash"}),t.jsx(H,{value:"Bank transfer",className:"cursor-pointer hover:bg-gray-200",children:"Bank Transfer"}),t.jsx(H,{value:"Others",className:"cursor-pointer hover:bg-gray-200",children:"Others..."})]})]})]}),t.jsxs("div",{className:"flex-1 min-w-[200px]",children:[t.jsx(Q,{htmlFor:"notes",children:"Notes (Optional)"}),t.jsx(le,{placeholder:"Type your notes here...",value:S.notes,onChange:v=>O(g,v.target.value)})]}),g>0&&t.jsx(te,{type:"button",className:"bg-red-500 hover:bg-red-400 h-8 w-8 m-2 rounded-full text-white text-sm absolute top-0 right-0",onClick:()=>R(g),children:t.jsx(ve,{icon:st})})]},g)})}),t.jsx("div",{className:"pb-10 flex justify-end items-center",children:t.jsxs(te,{className:"bg-blue-500 hover:bg-blue-400 ",onClick:k,disabled:D,children:[t.jsx(ve,{icon:Fe,className:"mr-2"})," Add Tithers"]})}),t.jsx("div",{className:"p-4 border border-b-4 border-primary rounded-lg flex flex-wrap gap-3",children:t.jsx(qt,{})})]}),t.jsx(Ge,{children:t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsx(xt,{asChild:!0,children:t.jsx(te,{type:"button",className:"bg-red-500 hover:bg-red-400",disabled:C,children:"Cancel"})}),t.jsx(te,{type:"submit",className:"bg-blue-500 hover:bg-blue-400",onClick:K,disabled:C,children:C?t.jsxs(t.Fragment,{children:[t.jsx("span",{children:"Submitting..."}),t.jsx("span",{className:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4 ml-2"})]}):t.jsx(t.Fragment,{children:"Submit"})})]})})]})})},Ye=A.forwardRef(({className:e,...a},r)=>t.jsx("textarea",{className:it("flex min-h-[60px] w-full rounded-md border border-primary bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...a}));Ye.displayName="Textarea";function zt({tithe:e,editingTitheId:a,setEditingTitheId:r,handleEditTithe:s,index:n,setTithes:i}){var j;const o=new Date(e.created_at),m=St(o),[x,C]=A.useState({}),D=()=>{const h={};(!e.amount||parseFloat(e.amount)===0)&&(h.amount="Amount must be greater than zero."),e.type||(h.type="Type is required."),e.payment_method||(h.payment_method="Payment method is required."),C(h),Object.keys(h).length===0&&s(e)};return t.jsxs(Re,{open:a===e.id,onOpenChange:h=>{!h&&(e.amount===""||parseFloat(e.amount)===0)||r(h?e.id:null)},children:[t.jsx(pt,{asChild:!0,children:t.jsx(te,{className:`text-white w-7 h-7 rounded-md ${m?"bg-green-500 hover:bg-green-400":""}`,disabled:!m,children:t.jsx(ve,{icon:ot})})}),t.jsxs(ke,{children:[t.jsxs(Me,{className:"text-start",children:[t.jsx(Pe,{children:"Edit tithes"}),t.jsxs(Le,{children:["Make changes to your tithes here. Click save when you're done.",t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(Q,{htmlFor:"name",className:"text-start",children:"Fullname"}),t.jsx(le,{value:(j=e.member)==null?void 0:j.name,readOnly:!0,className:"col-span-3 cursor-not-allowed"})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(Q,{htmlFor:"date_created",className:"text-start",children:"Date created"}),t.jsx(le,{value:e.date_created,type:"date",onChange:h=>i(p=>{const u=[...p];return u[n].date_created=h.target.value,u}),className:"col-span-3"})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(Q,{htmlFor:"amount",className:"text-start",children:"Amount"}),t.jsx(Ze,{thousandSeparator:!0,prefix:"₱ ",decimalScale:2,fixedDecimalScale:!0,allowNegative:!1,value:e.amount,onValueChange:h=>i(p=>{const u=[...p];return u[n].amount=h.value,u}),className:"flex h-9 w-full col-span-3 rounded-md border border-primary bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",placeholder:"0.00"}),x.amount&&t.jsx("span",{className:"text-red-500 text-xs col-span-3",children:x.amount})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(Q,{htmlFor:"type",className:"text-start",children:"Type"}),t.jsxs(ue,{value:e.type,onValueChange:h=>i(p=>{const u=[...p];return u[n].type=h,u}),children:[t.jsx(fe,{className:"col-span-3",children:t.jsx(me,{placeholder:"Select a type"})}),t.jsxs(he,{children:[t.jsx(H,{value:"Tithes and Offering",children:"Tithes and Offering"}),t.jsx(H,{value:"Help fund",children:"Help fund"}),t.jsx(H,{value:"Solomon Pledge",children:"Solomon Pledge"})]})]}),x.type&&t.jsx("span",{className:"text-red-500 text-xs col-span-3",children:x.type})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(Q,{htmlFor:"paymentMethod",className:"text-start",children:"Payment method"}),t.jsxs(ue,{value:e.payment_method,onValueChange:h=>i(p=>{const u=[...p];return u[n].payment_method=h,u}),children:[t.jsx(fe,{className:"col-span-3",children:t.jsx(me,{placeholder:"Select a payment method"})}),t.jsxs(he,{children:[t.jsx(H,{value:"Cash",children:"Cash"}),t.jsx(H,{value:"Gcash",children:"Gcash"}),t.jsx(H,{value:"Bank transfer",children:"Bank transfer"}),t.jsx(H,{value:"Others",children:"Others"})]})]}),x.payment_method&&t.jsx("span",{className:"text-red-500 text-xs col-span-3",children:x.payment_method})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(Q,{htmlFor:"notes",className:"text-start",children:"Notes"}),t.jsx(Ye,{value:e.notes,onChange:h=>i(p=>{const u=[...p];return u[n].notes=h.target.value,u}),className:"col-span-3",placeholder:"Add notes"})]})]})]})]}),t.jsx(Ge,{children:t.jsx(te,{type:"button",onClick:D,children:"Save changes"})})]})]})}function ia(){const[e,a]=A.useState({}),[r,s]=A.useState([{type:"Tithes and Offering",paymentMethod:"Cash",amount:"",notes:""}]),[n,i]=A.useState([]),[o,m]=A.useState([]),[x,C]=A.useState(!1),[D,j]=A.useState(!1),[h,p]=A.useState(!1),[u,O]=A.useState({}),[V,b]=A.useState(""),[k,R]=A.useState(null);A.useEffect(()=>{$()},[]);const $=async()=>{try{const l=await be.get("tithes",{headers:{"Content-Type":"application/json"}});i(l.data.listOfMembers),m(l.data.tithes)}catch(l){console.error("Error fetching members:",l)}},K=()=>{const l={};return r.forEach((v,T)=>{e[T]||(l[T]={...l[T],member:"Member is required"}),(!v.amount||parseFloat(v.amount)<=0)&&(l[T]={...l[T],amount:"Amount must be greater than 0"})}),O(l),Object.keys(l).length===0},S=async()=>{if(D||!K())return;j(!0),p(!0);const l=r.map((v,T)=>({member_id:e[T],type:v.type,amount:parseFloat(v.amount),payment_method:v.paymentMethod,notes:v.notes}));try{const v=await be.post("tithes",{tithes:l},{headers:{"Content-Type":"application/json"}});s([{type:"Tithes and Offering",paymentMethod:"Cash",amount:"",notes:""}]),a({}),C(!1),$();const T=v.data.message,L=T.includes("Note: Some members already had tithes recorded today.");ne.fire({icon:L?"warning":"success",title:L?"Partial Success":"Success",text:T,timer:3e3,showConfirmButton:!1,timerProgressBar:!0})}catch(v){console.error("Error submitting tithes:",v)}finally{j(!1),p(!1)}},g=async l=>{try{const v=await be.put(`tithes/${l.id}`,l,{headers:{"Content-Type":"application/json"}});$(),R(null);const T=v.data.message,L=T.includes("Note: Some members already had tithes recorded today.");ne.fire({icon:L?"warning":"success",title:L?"Partial Success":"Success",text:T,timer:2e3,showConfirmButton:!1}),m(z=>z.map(Z=>Z.id===l.id?v.data.tithes:Z))}catch(v){console.error("Error updating tithes:",v),ne.fire({icon:"error",title:"Error",text:"Failed to update tithes. Please try again."})}},d=o.filter(l=>{var v;return(((v=l.member)==null?void 0:v.name)||"").toLowerCase().includes(V.toLowerCase())||l.type.toLowerCase().includes(V.toLowerCase())||l.payment_method.toLowerCase().includes(V.toLowerCase())||(l.notes||"").toLowerCase().includes(V.toLowerCase())});return t.jsxs("div",{className:"ml-56 mx-auto md:ml-0 md:w-full mt-3",children:[t.jsx("div",{className:"grid grid-cols-3 gap-4",children:t.jsx("div",{className:"col-span-3",children:t.jsx("div",{className:"rounded-md min-h-80 pl-2 md:pl-0",children:t.jsxs(ht,{children:[t.jsxs("div",{className:"py-2 flex flex-row justify-between",children:[t.jsx(vt,{className:"text-lg md:text-base md:hidden",children:"Tithes today"}),t.jsx("div",{className:"grid md:justify-end md:gap-2",children:t.jsx(le,{type:"text",placeholder:"Search by name, type, payment method, or notes",className:"w-52 placeholder-small md:w-[95%]",value:V,onChange:l=>b(l.target.value)})})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs(gt,{className:"w-full",children:[t.jsx(_e,{children:t.jsxs(ie,{children:[t.jsx(q,{className:"text-center md:text-xs",children:"#"}),t.jsx(q,{className:"text-center md:text-xs",children:"Photo"}),t.jsx(q,{className:"md:text-xs",children:"Full Name"}),t.jsx(q,{className:"md:text-xs",children:"Amount"}),t.jsx(q,{className:"md:text-xs",children:"Type"}),t.jsx(q,{className:"md:text-xs",children:"Payment Method"}),t.jsx(q,{className:"md:text-xs",children:"Date Giving"}),t.jsx(q,{className:"md:text-xs",children:"Notes"}),t.jsx(q,{className:"text-right md:text-xs",children:"Action"})]})}),t.jsxs(Be,{children:[d.length===0&&t.jsx(ie,{children:t.jsx(U,{colSpan:9,className:"text-center",children:"No tithes found."})}),d.map((l,v)=>{var T,L;return t.jsxs(ie,{children:[t.jsx(U,{className:"md:text-xs",children:v+1}),t.jsx(U,{className:"flex justify-center md:justify-center item-center md:h-24 ",children:(T=l.member)!=null&&T.photo?t.jsx("img",{src:`https://jamctagoloan.xyz/storage/${l==null?void 0:l.member.photo}`,alt:l.member.name,className:"rounded-full h-10 w-10"}):t.jsxs(ct,{children:[t.jsx(dt,{src:"https://github.com/shadcn.png"}),t.jsx(ut,{children:"CN"})]})}),t.jsx(U,{className:"md:text-xs",children:(L=l.member)==null?void 0:L.name}),t.jsx(U,{className:"md:text-xs",children:l.amount.toLocaleString("en-US",{style:"currency",currency:"PHP"})}),t.jsx(U,{className:"md:text-xs",children:l.type}),t.jsxs(U,{className:"md:text-xs",children:[l.payment_method==="Cash"&&t.jsx("span",{className:"inline-flex items-center rounded-md bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-green-600/20 ring-inset",children:"Cash"}),l.payment_method==="Gcash"&&t.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-blue-700/10 ring-inset",children:"Gcash"}),l.payment_method==="Bank transfer"&&t.jsx("span",{className:"inline-flex items-center rounded-md bg-purple-50 px-2 py-1 text-xs font-medium text-purple-700 ring-1 ring-purple-700/10 ring-inset",children:"Bank transfer"}),l.payment_method==="Others"&&t.jsx("span",{className:"inline-flex items-center rounded-md bg-[#1f2937] px-2 py-1 text-xs font-medium text-light",children:"Others"})]}),t.jsx(U,{className:"md:text-xs",children:yt(new Date(l.date_created),"MMMM dd, yyyy")}),t.jsx(U,{className:"md:text-xs",children:l.notes||"None"}),t.jsx(U,{className:"text-right",children:t.jsxs("div",{className:"flex justify-end md:flex-col md:gap-3 items-center gap-1",children:[t.jsx(zt,{tithe:l,editingTitheId:k,setEditingTitheId:R,handleEditTithe:g,index:v,setTithes:m}),t.jsx(te,{variant:"destructive",size:"icon",onClick:async()=>{if((await ne.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!"})).isConfirmed)try{await be.delete(`tithes/${l.id}`),$(),ne.fire("Deleted!","The tithes has been deleted.","success")}catch(Z){console.error("Error deleting tithes:",Z),ne.fire("Error!","Failed to delete tithes. Please try again.","error")}},className:"h-8 w-8 rounded-md hover:bg-red-500 hover:text-white focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:t.jsx(ve,{icon:lt})})]})})]},l.id)})]})]})})]})})})}),t.jsx(te,{onClick:()=>C(!0),className:"fixed bottom-20 right-4 w-12 h-12 rounded-full bg-primary text-white shadow-lg flex items-center justify-center",children:t.jsx(ve,{icon:Fe})}),t.jsx(Qt,{isDialogOpen:x,setIsDialogOpen:C,rows:r,setRows:s,selectedMembers:e,setSelectedMembers:a,members:n,errors:u,handleSubmit:S,loading:D,isAddDisabled:h})]})}export{ia as default};
