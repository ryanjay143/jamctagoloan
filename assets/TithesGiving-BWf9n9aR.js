import{R as se,r as I,j as t,I as le,t as q,B as te,F as ve,C as st,w as Fe,D as it,s as ot,E as lt}from"./index-o9D0iVQb.js";import{A as ct,a as dt,b as ut}from"./avatar-VbNPoFEk.js";import{j as mt,b as _e,c as ie,d as Q,e as Be,f as U,k as ft,C as ht,a as vt,T as gt}from"./card-BQppXDjr.js";import{a as be}from"./axios-1xl_CE3x.js";import{S as ne}from"./sweetalert2.esm.all-B0Dix5B2.js";import{D as Re,b as ke,c as Me,d as Pe,e as Le,f as Ge,g as xt,a as pt}from"./dialog-JqB9tmZR.js";import{S as ue,a as me,b as fe,c as he,d as H}from"./select-CqGJDulQ.js";import{c as $e,n as bt,s as Te,f as yt}from"./format-B3-TfKxp.js";import"./index-Bw6kFwjO.js";import"./index-Cef4SG8U.js";function jt(e){return $e(e,Date.now())}function Nt(e,a,r){const[s,n]=bt(r==null?void 0:r.in,e,a);return+Te(s)==+Te(n)}function St(e,a){return Nt($e(e,e),jt(e))}function Ke(e,a){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&a.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(e);n<s.length;n++)a.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(r[s[n]]=e[s[n]]);return r}var ge;(function(e){e.event="event",e.props="prop"})(ge||(ge={}));function ee(){}function wt(e){var a,r=void 0;return function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return a&&s.length===a.length&&s.every(function(i,o){return i===a[o]})||(a=s,r=e.apply(void 0,s)),r}}function xe(e){return!!(e||"").match(/\d/)}function oe(e){return e==null}function Ct(e){return typeof e=="number"&&isNaN(e)}function He(e){return oe(e)||Ct(e)||typeof e=="number"&&!isFinite(e)}function Ue(e){return e.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")}function Dt(e){switch(e){case"lakh":return/(\d+?)(?=(\d\d)+(\d)(?!\d))(\.\d+)?/g;case"wan":return/(\d)(?=(\d{4})+(?!\d))/g;case"thousand":default:return/(\d)(?=(\d{3})+(?!\d))/g}}function Vt(e,a,r){var s=Dt(r),n=e.search(/[1-9]/);return n=n===-1?e.length:n,e.substring(0,n)+e.substring(n,e.length).replace(s,"$1"+a)}function Tt(e){var a=I.useRef(e);a.current=e;var r=I.useRef(function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return a.current.apply(a,s)});return r.current}function De(e,a){a===void 0&&(a=!0);var r=e[0]==="-",s=r&&a;e=e.replace("-","");var n=e.split("."),i=n[0],o=n[1]||"";return{beforeDecimal:i,afterDecimal:o,hasNegation:r,addNegation:s}}function It(e){if(!e)return e;var a=e[0]==="-";a&&(e=e.substring(1,e.length));var r=e.split("."),s=r[0].replace(/^0+/,"")||"0",n=r[1]||"";return(a?"-":"")+s+(n?"."+n:"")}function We(e,a,r){for(var s="",n=r?"0":"",i=0;i<=a-1;i++)s+=e[i]||n;return s}function Ie(e,a){return Array(a+1).join(e)}function Qe(e){var a=e+"",r=a[0]==="-"?"-":"";r&&(a=a.substring(1));var s=a.split(/[eE]/g),n=s[0],i=s[1];if(i=Number(i),!i)return r+n;n=n.replace(".","");var o=1+i,f=n.length;return o<0?n="0."+Ie("0",Math.abs(o))+n:o>=f?n=n+Ie("0",o-f):n=(n.substring(0,o)||"0")+"."+n.substring(o),r+n}function Ae(e,a,r){if(["","-"].indexOf(e)!==-1)return e;var s=(e.indexOf(".")!==-1||r)&&a,n=De(e),i=n.beforeDecimal,o=n.afterDecimal,f=n.hasNegation,x=parseFloat("0."+(o||"0")),C=o.length<=a?"0."+o:x.toFixed(a),D=C.split("."),j=i;i&&Number(D[0])&&(j=i.split("").reverse().reduce(function(A,V,b){return A.length>b?(Number(A[0])+Number(V)).toString()+A.substring(1,A.length):V+A},D[0]));var h=We(D[1]||"",a,r),p=f?"-":"",u=s?".":"";return""+p+j+u+h}function ae(e,a){if(e.value=e.value,e!==null){if(e.createTextRange){var r=e.createTextRange();return r.move("character",a),r.select(),!0}return e.selectionStart||e.selectionStart===0?(e.focus(),e.setSelectionRange(a,a),!0):(e.focus(),!1)}}var qe=wt(function(e,a){for(var r=0,s=0,n=e.length,i=a.length;e[r]===a[r]&&r<n;)r++;for(;e[n-1-s]===a[i-1-s]&&i-s>r&&n-s>r;)s++;return{from:{start:r,end:n-s},to:{start:r,end:i-s}}}),At=function(e,a){var r=Math.min(e.selectionStart,a);return{from:{start:r,end:e.selectionEnd},to:{start:r,end:a}}};function Ot(e,a,r){return Math.min(Math.max(e,a),r)}function Ce(e){return Math.max(e.selectionStart,e.selectionEnd)}function Et(){return typeof navigator<"u"&&!(navigator.platform&&/iPhone|iPod/.test(navigator.platform))}function Ft(e){return{from:{start:0,end:0},to:{start:0,end:e.length},lastValue:""}}function _t(e){var a=e.currentValue,r=e.formattedValue,s=e.currentValueIndex,n=e.formattedValueIndex;return a[s]===r[n]}function Bt(e,a,r,s,n,i,o){o===void 0&&(o=_t);var f=n.findIndex(function($){return $}),x=e.slice(0,f);!a&&!r.startsWith(x)&&(a=x,r=x+r,s=s+x.length);for(var C=r.length,D=e.length,j={},h=new Array(C),p=0;p<C;p++){h[p]=-1;for(var u=0,A=D;u<A;u++){var V=o({currentValue:r,lastValue:a,formattedValue:e,currentValueIndex:p,formattedValueIndex:u});if(V&&j[u]!==!0){h[p]=u,j[u]=!0;break}}}for(var b=s;b<C&&(h[b]===-1||!i(r[b]));)b++;var k=b===C||h[b]===-1?D:h[b];for(b=s-1;b>0&&h[b]===-1;)b--;var R=b===-1||h[b]===-1?0:h[b]+1;return R>k?k:s-R<k-s?R:k}function Oe(e,a,r,s){var n=e.length;if(a=Ot(a,0,n),s==="left"){for(;a>=0&&!r[a];)a--;a===-1&&(a=r.indexOf(!0))}else{for(;a<=n&&!r[a];)a++;a>n&&(a=r.lastIndexOf(!0))}return a===-1&&(a=n),a}function Rt(e){for(var a=Array.from({length:e.length+1}).map(function(){return!0}),r=0,s=a.length;r<s;r++)a[r]=!!(xe(e[r])||xe(e[r-1]));return a}function ze(e,a,r,s,n,i){i===void 0&&(i=ee);var o=Tt(function(u,A){var V,b;return He(u)?(b="",V=""):typeof u=="number"||A?(b=typeof u=="number"?Qe(u):u,V=s(b)):(b=n(u,void 0),V=s(b)),{formattedValue:V,numAsString:b}}),f=I.useState(function(){return o(oe(e)?a:e,r)}),x=f[0],C=f[1],D=function(u,A){u.formattedValue!==x.formattedValue&&C({formattedValue:u.formattedValue,numAsString:u.value}),i(u,A)},j=e,h=r;oe(e)&&(j=x.numAsString,h=!0);var p=o(j,h);return I.useMemo(function(){C(p)},[p.formattedValue]),[x,D]}function kt(e){return e.replace(/[^0-9]/g,"")}function Mt(e){return e}function Pt(e){var a=e.type;a===void 0&&(a="text");var r=e.displayType;r===void 0&&(r="input");var s=e.customInput,n=e.renderText,i=e.getInputRef,o=e.format;o===void 0&&(o=Mt);var f=e.removeFormatting;f===void 0&&(f=kt);var x=e.defaultValue,C=e.valueIsNumericString,D=e.onValueChange,j=e.isAllowed,h=e.onChange;h===void 0&&(h=ee);var p=e.onKeyDown;p===void 0&&(p=ee);var u=e.onMouseUp;u===void 0&&(u=ee);var A=e.onFocus;A===void 0&&(A=ee);var V=e.onBlur;V===void 0&&(V=ee);var b=e.value,k=e.getCaretBoundary;k===void 0&&(k=Rt);var R=e.isValidInputCharacter;R===void 0&&(R=xe);var $=e.isCharacterSame,K=Ke(e,["type","displayType","customInput","renderText","getInputRef","format","removeFormatting","defaultValue","valueIsNumericString","onValueChange","isAllowed","onChange","onKeyDown","onMouseUp","onFocus","onBlur","value","getCaretBoundary","isValidInputCharacter","isCharacterSame"]),S=ze(b,x,!!C,o,f,D),g=S[0],c=g.formattedValue,d=g.numAsString,v=S[1],O=I.useRef(),L=I.useRef({formattedValue:c,numAsString:d}),z=function(l,m){L.current={formattedValue:l.formattedValue,numAsString:l.value},v(l,m)},Z=I.useState(!1),ce=Z[0],w=Z[1],y=I.useRef(null),E=I.useRef({setCaretTimeout:null,focusTimeout:null});I.useEffect(function(){return w(!0),function(){clearTimeout(E.current.setCaretTimeout),clearTimeout(E.current.focusTimeout)}},[]);var M=o,P=function(l,m){var N=parseFloat(m);return{formattedValue:l,value:m,floatValue:isNaN(N)?void 0:N}},B=function(l,m,N){l.selectionStart===0&&l.selectionEnd===l.value.length||(ae(l,m),E.current.setCaretTimeout=setTimeout(function(){l.value===N&&l.selectionStart!==m&&ae(l,m)},0))},G=function(l,m,N){return Oe(l,m,k(l),N)},re=function(l,m,N){var F=k(m),W=Bt(m,c,l,N,F,R,$);return W=Oe(m,W,F),W},je=function(l){var m=l.formattedValue;m===void 0&&(m="");var N=l.input,F=l.source,W=l.event,_=l.numAsString,T;if(N){var Y=l.inputValue||N.value,J=Ce(N);N.value=m,T=re(Y,m,J),T!==void 0&&B(N,T,m)}m!==c&&z(P(m,_),{event:W,source:F})};I.useEffect(function(){var l=L.current,m=l.formattedValue,N=l.numAsString;(c!==m||d!==N)&&z(P(c,d),{event:void 0,source:ge.props})},[c,d]);var de=y.current?Ce(y.current):void 0,pe=typeof window<"u"?I.useLayoutEffect:I.useEffect;pe(function(){var l=y.current;if(c!==L.current.formattedValue&&l){var m=re(L.current.formattedValue,c,de);l.value=c,B(l,m,c)}},[c]);var Ne=function(l,m,N){var F=m.target,W=O.current?At(O.current,F.selectionEnd):qe(c,l),_=Object.assign(Object.assign({},W),{lastValue:c}),T=f(l,_),Y=M(T);if(T=f(Y,void 0),j&&!j(P(Y,T))){var J=m.target,X=Ce(J),we=re(l,c,X);return J.value=c,B(J,we,c),!1}return je({formattedValue:Y,numAsString:T,inputValue:l,event:m,source:N,input:m.target}),!0},Se=function(l,m){m===void 0&&(m=0);var N=l.selectionStart,F=l.selectionEnd;O.current={selectionStart:N,selectionEnd:F+m}},Je=function(l){var m=l.target,N=m.value,F=Ne(N,l,ge.event);F&&h(l),O.current=void 0},Xe=function(l){var m=l.target,N=l.key,F=m.selectionStart,W=m.selectionEnd,_=m.value;_===void 0&&(_="");var T;N==="ArrowLeft"||N==="Backspace"?T=Math.max(F-1,0):N==="ArrowRight"?T=Math.min(F+1,_.length):N==="Delete"&&(T=F);var Y=0;N==="Delete"&&F===W&&(Y=1);var J=N==="ArrowLeft"||N==="ArrowRight";if(T===void 0||F!==W&&!J){p(l),Se(m,Y);return}var X=T;if(J){var we=N==="ArrowLeft"?"left":"right";X=G(_,T,we),X!==T&&l.preventDefault()}else N==="Delete"&&!R(_[T])?X=G(_,T,"right"):N==="Backspace"&&!R(_[T])&&(X=G(_,T,"left"));X!==T&&B(m,X,_),p(l),Se(m,Y)},et=function(l){var m=l.target,N=function(){var F=m.selectionStart,W=m.selectionEnd,_=m.value;if(_===void 0&&(_=""),F===W){var T=G(_,F);T!==F&&B(m,T,_)}};N(),requestAnimationFrame(function(){N()}),u(l),Se(m)},tt=function(l){l.persist&&l.persist();var m=l.target,N=l.currentTarget;y.current=m,E.current.focusTimeout=setTimeout(function(){var F=m.selectionStart,W=m.selectionEnd,_=m.value;_===void 0&&(_="");var T=G(_,F);T!==F&&!(F===0&&W===_.length)&&B(m,T,_),A(Object.assign(Object.assign({},l),{currentTarget:N}))},0)},at=function(l){y.current=null,clearTimeout(E.current.focusTimeout),clearTimeout(E.current.setCaretTimeout),V(l)},rt=ce&&Et()?"numeric":void 0,Ve=Object.assign({inputMode:rt},K,{type:a,value:c,onChange:Je,onKeyDown:Xe,onMouseUp:et,onFocus:tt,onBlur:at});if(r==="text")return n?se.createElement(se.Fragment,null,n(c,K)||null):se.createElement("span",Object.assign({},K,{ref:i}),c);if(s){var nt=s;return se.createElement(nt,Object.assign({},Ve,{ref:i}))}return se.createElement("input",Object.assign({},Ve,{ref:i}))}function Ee(e,a){var r=a.decimalScale,s=a.fixedDecimalScale,n=a.prefix;n===void 0&&(n="");var i=a.suffix;i===void 0&&(i="");var o=a.allowNegative,f=a.thousandsGroupStyle;if(f===void 0&&(f="thousand"),e===""||e==="-")return e;var x=ye(a),C=x.thousandSeparator,D=x.decimalSeparator,j=r!==0&&e.indexOf(".")!==-1||r&&s,h=De(e,o),p=h.beforeDecimal,u=h.afterDecimal,A=h.addNegation;return r!==void 0&&(u=We(u,r,!!s)),C&&(p=Vt(p,C,f)),n&&(p=n+p),i&&(u=u+i),A&&(p="-"+p),e=p+(j&&D||"")+u,e}function ye(e){var a=e.decimalSeparator;a===void 0&&(a=".");var r=e.thousandSeparator,s=e.allowedDecimalSeparators;return r===!0&&(r=","),s||(s=[a,"."]),{decimalSeparator:a,thousandSeparator:r,allowedDecimalSeparators:s}}function Lt(e,a){e===void 0&&(e="");var r=new RegExp("(-)"),s=new RegExp("(-)(.)*(-)"),n=r.test(e),i=s.test(e);return e=e.replace(/-/g,""),n&&!i&&a&&(e="-"+e),e}function Gt(e,a){return new RegExp("(^-)|[0-9]|"+Ue(e),"g")}function $t(e,a,r){return e===""?!0:!(a!=null&&a.match(/\d/))&&!(r!=null&&r.match(/\d/))&&typeof e=="string"&&!isNaN(Number(e))}function Kt(e,a,r){var s;a===void 0&&(a=Ft(e));var n=r.allowNegative,i=r.prefix;i===void 0&&(i="");var o=r.suffix;o===void 0&&(o="");var f=r.decimalScale,x=a.from,C=a.to,D=C.start,j=C.end,h=ye(r),p=h.allowedDecimalSeparators,u=h.decimalSeparator,A=e[j]===u;if(xe(e)&&(e===i||e===o)&&a.lastValue==="")return e;if(j-D===1&&p.indexOf(e[D])!==-1){var V=f===0?"":u;e=e.substring(0,D)+V+e.substring(D+1,e.length)}var b=function(y,E,M){var P=!1,B=!1;i.startsWith("-")?P=!1:y.startsWith("--")?(P=!1,B=!0):o.startsWith("-")&&y.length===o.length?P=!1:y[0]==="-"&&(P=!0);var G=P?1:0;return B&&(G=2),G&&(y=y.substring(G),E-=G,M-=G),{value:y,start:E,end:M,hasNegation:P}},k=b(e,D,j),R=k.hasNegation;s=k,e=s.value,D=s.start,j=s.end;var $=b(a.lastValue,x.start,x.end),K=$.start,S=$.end,g=$.value,c=e.substring(D,j);e.length&&g.length&&(K>g.length-o.length||S<i.length)&&!(c&&o.startsWith(c))&&(e=g);var d=0;e.startsWith(i)?d+=i.length:D<i.length&&(d=D),e=e.substring(d),j-=d;var v=e.length,O=e.length-o.length;e.endsWith(o)?v=O:(j>O||j>e.length-o.length)&&(v=j),e=e.substring(0,v),e=Lt(R?"-"+e:e,n),e=(e.match(Gt(u))||[]).join("");var L=e.indexOf(u);e=e.replace(new RegExp(Ue(u),"g"),function(y,E){return E===L?".":""});var z=De(e,n),Z=z.beforeDecimal,ce=z.afterDecimal,w=z.addNegation;return C.end-C.start<x.end-x.start&&Z===""&&A&&!parseFloat(ce)&&(e=w?"-":""),e}function Ht(e,a){var r=a.prefix;r===void 0&&(r="");var s=a.suffix;s===void 0&&(s="");var n=Array.from({length:e.length+1}).map(function(){return!0}),i=e[0]==="-";n.fill(!1,0,r.length+(i?1:0));var o=e.length;return n.fill(!1,o-s.length+1,o+1),n}function Ut(e){var a=ye(e),r=a.thousandSeparator,s=a.decimalSeparator,n=e.prefix;n===void 0&&(n="");var i=e.allowNegative;if(i===void 0&&(i=!0),r===s)throw new Error(`
        Decimal separator can't be same as thousand separator.
        thousandSeparator: `+r+` (thousandSeparator = {true} is same as thousandSeparator = ",")
        decimalSeparator: `+s+` (default value for decimalSeparator is .)
     `);return n.startsWith("-")&&i&&(console.error(`
      Prefix can't start with '-' when allowNegative is true.
      prefix: `+n+`
      allowNegative: `+i+`
    `),i=!1),Object.assign(Object.assign({},e),{allowNegative:i})}function Wt(e){e=Ut(e),e.decimalSeparator,e.allowedDecimalSeparators,e.thousandsGroupStyle;var a=e.suffix,r=e.allowNegative,s=e.allowLeadingZeros,n=e.onKeyDown;n===void 0&&(n=ee);var i=e.onBlur;i===void 0&&(i=ee);var o=e.thousandSeparator,f=e.decimalScale,x=e.fixedDecimalScale,C=e.prefix;C===void 0&&(C="");var D=e.defaultValue,j=e.value,h=e.valueIsNumericString,p=e.onValueChange,u=Ke(e,["decimalSeparator","allowedDecimalSeparators","thousandsGroupStyle","suffix","allowNegative","allowLeadingZeros","onKeyDown","onBlur","thousandSeparator","decimalScale","fixedDecimalScale","prefix","defaultValue","value","valueIsNumericString","onValueChange"]),A=ye(e),V=A.decimalSeparator,b=A.allowedDecimalSeparators,k=function(w){return Ee(w,e)},R=function(w,y){return Kt(w,y,e)},$=oe(j)?D:j,K=h??$t($,C,a);oe(j)?oe(D)||(K=K||typeof D=="number"):K=K||typeof j=="number";var S=function(w){return He(w)?w:(typeof w=="number"&&(w=Qe(w)),K&&typeof f=="number"?Ae(w,f,!!x):w)},g=ze(S(j),S(D),!!K,k,R,p),c=g[0],d=c.numAsString,v=c.formattedValue,O=g[1],L=function(w){var y=w.target,E=w.key,M=y.selectionStart,P=y.selectionEnd,B=y.value;if(B===void 0&&(B=""),(E==="Backspace"||E==="Delete")&&P<C.length){w.preventDefault();return}if(M!==P){n(w);return}E==="Backspace"&&B[0]==="-"&&M===C.length+1&&r&&ae(y,1),f&&x&&(E==="Backspace"&&B[M-1]===V?(ae(y,M-1),w.preventDefault()):E==="Delete"&&B[M]===V&&w.preventDefault()),b!=null&&b.includes(E)&&B[M]===V&&ae(y,M+1);var G=o===!0?",":o;E==="Backspace"&&B[M-1]===G&&ae(y,M-1),E==="Delete"&&B[M]===G&&ae(y,M+1),n(w)},z=function(w){var y=d;if(y.match(/\d/g)||(y=""),s||(y=It(y)),x&&f&&(y=Ae(y,f,x)),y!==d){var E=Ee(y,e);O({formattedValue:E,value:y,floatValue:parseFloat(y)},{event:w,source:ge.event})}i(w)},Z=function(w){return w===V?!0:xe(w)},ce=function(w){var y=w.currentValue,E=w.lastValue,M=w.formattedValue,P=w.currentValueIndex,B=w.formattedValueIndex,G=y[P],re=M[B],je=qe(E,y),de=je.to,pe=function(Ne){return R(Ne).indexOf(".")+C.length};return j===0&&x&&f&&y[de.start]===V&&pe(y)<P&&pe(M)>B?!1:P>=de.start&&P<de.end&&b&&b.includes(G)&&re===V?!0:G===re};return Object.assign(Object.assign({},u),{value:v,valueIsNumericString:!1,isValidInputCharacter:Z,isCharacterSame:ce,onValueChange:O,format:k,removeFormatting:R,getCaretBoundary:function(w){return Ht(w,e)},onKeyDown:L,onBlur:z})}function Ze(e){var a=Wt(e);return se.createElement(Pt,Object.assign({},a))}function Qt(){const e=[1e3,500,200,100,50,20,10,5,1],[a,r]=I.useState(Array(e.length).fill(0)),s=(o,f)=>{const x=[...a];x[o]=parseInt(f)||0,r(x)},n=(o,f)=>o*f,i=a.reduce((o,f,x)=>o+n(e[x],f),0);return t.jsxs(mt,{children:[t.jsx(_e,{children:t.jsxs(ie,{children:[t.jsx(Q,{className:"text-center border border-white",children:"Denomination"}),t.jsx(Q,{className:"text-center border border-white",children:"Quantity"}),t.jsx(Q,{className:"text-center border border-white",children:"Amount"})]})}),t.jsx(Be,{children:e.map((o,f)=>t.jsxs(ie,{children:[t.jsx(U,{className:"text-center font-bold text-base border border-primary","data-value":o,children:o}),t.jsx(U,{className:"text-center border border-primary",children:t.jsx("div",{className:"flex justify-center items-center",children:t.jsx(le,{type:"number",placeholder:"0",min:"0",className:"w-full max-w-52",value:a[f]===0?"":a[f],onChange:x=>s(f,x.target.value)})})}),t.jsx(U,{className:"text-center font-bold text-base border border-primary",children:n(o,a[f])})]},o))}),t.jsx(ft,{children:t.jsxs(ie,{children:[t.jsx(U,{className:"text-right font-bold text-base border border-primary",colSpan:2,children:"Total Amount (Cash)"}),t.jsx(U,{className:"text-center font-bold text-base border border-primary",children:i})]})})]})}const qt=({isDialogOpen:e,setIsDialogOpen:a,rows:r,setRows:s,selectedMembers:n,setSelectedMembers:i,members:o,errors:f,handleSubmit:x,loading:C,isAddDisabled:D})=>{const j=(S,g)=>{i(c=>({...c,[S]:g}))},h=(S,g)=>{const c=[...r];c[S].type=g,s(c)},p=(S,g)=>{const c=[...r];c[S].paymentMethod=g,s(c)},u=(S,g)=>{const c=[...r];c[S].amount=g,s(c)},A=(S,g)=>{const c=[...r];c[S].notes=g,s(c)},V=(S,g)=>{const c=[...r];c[S].date_created=g,s(c)},b=()=>new Date().toISOString().split("T")[0],k=()=>{s(S=>[...S,{type:"Tithes and Offering",paymentMethod:"Cash",amount:"",notes:"",date_created:b()}])},R=S=>{s(g=>g.filter((c,d)=>d!==S)),i(g=>{const c={...g};return delete c[S],c})},$=S=>Object.values(n).includes(S),K=()=>{const S=b(),g=r.map(c=>({member_id:null,type:c.type,amount:c.amount,payment_method:c.paymentMethod,date_created:c.date_created||S,notes:c.notes}));console.log("Submitting data:",g),x({tithes:g})};return t.jsx(Re,{open:e,onOpenChange:a,children:t.jsxs(ke,{className:"overflow-auto h-screen w-[98%] max-w-6xl mx-auto backdrop-blur-sm",children:[t.jsxs(Me,{className:"text-start",children:[t.jsx(Pe,{children:"Add Tithes & Offering"}),t.jsx(Le,{children:r.map((S,g)=>{var c,d;return t.jsxs("div",{className:"mt-5 mb-5 p-7 border border-b-4 border-primary rounded-lg flex flex-wrap gap-3 relative",children:[t.jsxs("div",{className:"flex-1 min-w-[200px]",children:[t.jsx(q,{htmlFor:"date_created",children:"Date Created"}),t.jsx(le,{type:"date",value:S.date_created||b(),onChange:v=>V(g,v.target.value)})]}),t.jsxs("div",{className:"flex-1 min-w-[200px]",children:[t.jsxs(q,{htmlFor:"member",children:["Member ",t.jsx("span",{className:"text-gray-500 text-[11px]",children:"(If no name, it's okay to leave it blank)"})]}),t.jsxs(ue,{value:n[g]||"",onValueChange:v=>j(g,v),children:[t.jsx(me,{children:t.jsx(fe,{placeholder:"Select a member",defaultValue:n[g]?"":"No name"})}),t.jsx(he,{className:"overflow-auto max-h-[200px]",children:o.filter(v=>!$(v.id)||n[g]===v.id).map(v=>t.jsx(H,{value:v.id,className:"cursor-pointer hover:bg-gray-200",children:v.name},v.id))})]}),((c=f[g])==null?void 0:c.member)&&t.jsx("span",{className:"text-red-500 text-xs",children:f[g].member})]}),t.jsxs("div",{className:"flex-1 min-w-[200px]",children:[t.jsx(q,{htmlFor:"type",children:"Type:"}),t.jsxs(ue,{value:S.type,onValueChange:v=>h(g,v),children:[t.jsx(me,{children:t.jsx(fe,{placeholder:"Select a type"})}),t.jsxs(he,{children:[t.jsx(H,{value:"Tithes and Offering",className:"cursor-pointer hover:bg-gray-200",children:"Tithes and Offering"}),t.jsx(H,{value:"Help fund",className:"cursor-pointer hover:bg-gray-200",children:"Help Fund"}),t.jsx(H,{value:"Solomon Pledge",className:"cursor-pointer hover:bg-gray-200",children:"Solomon Pledge"}),t.jsx(H,{value:"Others",className:"cursor-pointer hover:bg-gray-200",children:"Others..."})]})]})]}),t.jsxs("div",{className:"flex-1 min-w-[200px]",children:[t.jsxs(q,{htmlFor:"amount",children:["Amount (PHP) ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(Ze,{thousandSeparator:!0,prefix:"₱ ",decimalScale:2,fixedDecimalScale:!0,allowNegative:!1,value:S.amount,onValueChange:v=>{const{value:O}=v;u(g,O)},className:"flex h-9 w-full rounded-md border border-primary bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",placeholder:"0.00"}),((d=f[g])==null?void 0:d.amount)&&t.jsx("span",{className:"text-red-500 text-xs",children:f[g].amount})]}),t.jsxs("div",{className:"flex-1 min-w-[200px]",children:[t.jsx(q,{htmlFor:"payment",children:"Payment Method"}),t.jsxs(ue,{value:S.paymentMethod,onValueChange:v=>p(g,v),children:[t.jsx(me,{children:t.jsx(fe,{placeholder:"Select a payment method"})}),t.jsxs(he,{children:[t.jsx(H,{value:"Cash",className:"cursor-pointer hover:bg-gray-200",children:"Cash"}),t.jsx(H,{value:"Gcash",className:"cursor-pointer hover:bg-gray-200",children:"Gcash"}),t.jsx(H,{value:"Bank transfer",className:"cursor-pointer hover:bg-gray-200",children:"Bank Transfer"}),t.jsx(H,{value:"Others",className:"cursor-pointer hover:bg-gray-200",children:"Others..."})]})]})]}),t.jsxs("div",{className:"flex-1 min-w-[200px]",children:[t.jsx(q,{htmlFor:"notes",children:"Notes (Optional)"}),t.jsx(le,{placeholder:"Type your notes here...",value:S.notes,onChange:v=>A(g,v.target.value)})]}),g>0&&t.jsx(te,{type:"button",className:"bg-red-500 hover:bg-red-400 h-8 w-8 m-2 rounded-full text-white text-sm absolute top-0 right-0",onClick:()=>R(g),children:t.jsx(ve,{icon:st})})]},g)})}),t.jsx("div",{className:"pb-10 flex justify-end items-center",children:t.jsxs(te,{className:"bg-blue-500 hover:bg-blue-400 ",onClick:k,disabled:D,children:[t.jsx(ve,{icon:Fe,className:"mr-2"})," Add Tithers"]})}),t.jsx("div",{className:"p-4 border border-b-4 border-primary rounded-lg flex flex-wrap gap-3",children:t.jsx(Qt,{})})]}),t.jsx(Ge,{children:t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsx(xt,{asChild:!0,children:t.jsx(te,{type:"button",className:"bg-red-500 hover:bg-red-400",disabled:C,children:"Cancel"})}),t.jsx(te,{type:"submit",className:"bg-blue-500 hover:bg-blue-400",onClick:K,disabled:C,children:C?t.jsxs(t.Fragment,{children:[t.jsx("span",{children:"Submitting..."}),t.jsx("span",{className:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4 ml-2"})]}):t.jsx(t.Fragment,{children:"Submit"})})]})})]})})},Ye=I.forwardRef(({className:e,...a},r)=>t.jsx("textarea",{className:it("flex min-h-[60px] w-full rounded-md border border-primary bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...a}));Ye.displayName="Textarea";function zt({tithe:e,editingTitheId:a,setEditingTitheId:r,handleEditTithe:s,index:n,setTithes:i}){var j;const o=new Date(e.created_at),f=St(o),[x,C]=I.useState({}),D=()=>{const h={};(!e.amount||parseFloat(e.amount)===0)&&(h.amount="Amount must be greater than zero."),e.type||(h.type="Type is required."),e.payment_method||(h.payment_method="Payment method is required."),C(h),Object.keys(h).length===0&&s(e)};return t.jsxs(Re,{open:a===e.id,onOpenChange:h=>{!h&&(e.amount===""||parseFloat(e.amount)===0)||r(h?e.id:null)},children:[t.jsx(pt,{asChild:!0,children:t.jsx(te,{className:`text-white w-7 h-7 rounded-md ${f?"bg-green-500 hover:bg-green-400":""}`,disabled:!f,children:t.jsx(ve,{icon:ot})})}),t.jsxs(ke,{children:[t.jsxs(Me,{className:"text-start",children:[t.jsx(Pe,{children:"Edit tithes"}),t.jsxs(Le,{children:["Make changes to your tithes here. Click save when you're done.",t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(q,{htmlFor:"name",className:"text-start",children:"Fullname"}),t.jsx(le,{value:((j=e.member)==null?void 0:j.name)||"No name",readOnly:!0,className:"col-span-3 cursor-not-allowed"})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(q,{htmlFor:"date_created",className:"text-start",children:"Date created"}),t.jsx(le,{value:e.date_created,type:"date",onChange:h=>i(p=>{const u=[...p];return u[n].date_created=h.target.value,u}),className:"col-span-3"})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(q,{htmlFor:"amount",className:"text-start",children:"Amount"}),t.jsx(Ze,{thousandSeparator:!0,prefix:"₱ ",decimalScale:2,fixedDecimalScale:!0,allowNegative:!1,value:e.amount,onValueChange:h=>i(p=>{const u=[...p];return u[n].amount=h.value,u}),className:"flex h-9 w-full col-span-3 rounded-md border border-primary bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",placeholder:"0.00"}),x.amount&&t.jsx("span",{className:"text-red-500 text-xs col-span-3",children:x.amount})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(q,{htmlFor:"type",className:"text-start",children:"Type"}),t.jsxs(ue,{value:e.type,onValueChange:h=>i(p=>{const u=[...p];return u[n].type=h,u}),children:[t.jsx(me,{className:"col-span-3",children:t.jsx(fe,{placeholder:"Select a type"})}),t.jsxs(he,{children:[t.jsx(H,{value:"Tithes and Offering",children:"Tithes and Offering"}),t.jsx(H,{value:"Help fund",children:"Help fund"}),t.jsx(H,{value:"Solomon Pledge",children:"Solomon Pledge"})]})]}),x.type&&t.jsx("span",{className:"text-red-500 text-xs col-span-3",children:x.type})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(q,{htmlFor:"paymentMethod",className:"text-start",children:"Payment method"}),t.jsxs(ue,{value:e.payment_method,onValueChange:h=>i(p=>{const u=[...p];return u[n].payment_method=h,u}),children:[t.jsx(me,{className:"col-span-3",children:t.jsx(fe,{placeholder:"Select a payment method"})}),t.jsxs(he,{children:[t.jsx(H,{value:"Cash",children:"Cash"}),t.jsx(H,{value:"Gcash",children:"Gcash"}),t.jsx(H,{value:"Bank transfer",children:"Bank transfer"}),t.jsx(H,{value:"Others",children:"Others"})]})]}),x.payment_method&&t.jsx("span",{className:"text-red-500 text-xs col-span-3",children:x.payment_method})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(q,{htmlFor:"notes",className:"text-start",children:"Notes"}),t.jsx(Ye,{value:e.notes,onChange:h=>i(p=>{const u=[...p];return u[n].notes=h.target.value,u}),className:"col-span-3",placeholder:"Add notes"})]})]})]})]}),t.jsx(Ge,{children:t.jsx(te,{type:"button",onClick:D,children:"Save changes"})})]})]})}function ia(){const[e,a]=I.useState({}),[r,s]=I.useState([{type:"Tithes and Offering",paymentMethod:"Cash",amount:"",notes:""}]),[n,i]=I.useState([]),[o,f]=I.useState([]),[x,C]=I.useState(!1),[D,j]=I.useState(!1),[h,p]=I.useState(!1),[u,A]=I.useState({}),[V,b]=I.useState(""),[k,R]=I.useState(null);I.useEffect(()=>{$()},[]);const $=async()=>{try{const d=await be.get("tithes",{headers:{"Content-Type":"application/json"}});i(d.data.listOfMembers),f(d.data.tithes)}catch(d){console.error("Error fetching members:",d)}},K=()=>{const d={};return r.forEach((v,O)=>{(!v.amount||parseFloat(v.amount)<=0)&&(d[O]={...d[O],amount:"Amount must be greater than 0"})}),A(d),Object.keys(d).length===0},S=async()=>{if(D||!K())return;j(!0),p(!0);const d=r.map((v,O)=>({member_id:e[O]||null,type:v.type,amount:parseFloat(v.amount),payment_method:v.paymentMethod,notes:v.notes}));try{const v=await be.post("tithes",{tithes:d},{headers:{"Content-Type":"application/json"}});s([{type:"Tithes and Offering",paymentMethod:"Cash",amount:"",notes:""}]),a({}),C(!1),$();const O=v.data.message,L=O.includes("Note: Some members already had tithes recorded today.");ne.fire({icon:L?"warning":"success",title:L?"Partial Success":"Success",text:O,timer:3e3,showConfirmButton:!1,timerProgressBar:!0})}catch(v){console.error("Error submitting tithes:",v)}finally{j(!1),p(!1)}},g=async d=>{try{const v=await be.put(`tithes/${d.id}`,d,{headers:{"Content-Type":"application/json"}});$(),R(null);const O=v.data.message,L=O.includes("Note: Some members already had tithes recorded today.");ne.fire({icon:L?"warning":"success",title:L?"Partial Success":"Success",text:O,timer:2e3,showConfirmButton:!1}),f(z=>z.map(Z=>Z.id===d.id?v.data.tithes:Z))}catch(v){console.error("Error updating tithes:",v),ne.fire({icon:"error",title:"Error",text:"Failed to update tithes. Please try again."})}},c=o.filter(d=>{var v;return(((v=d.member)==null?void 0:v.name)||"").toLowerCase().includes(V.toLowerCase())||d.type.toLowerCase().includes(V.toLowerCase())||d.payment_method.toLowerCase().includes(V.toLowerCase())||(d.notes||"").toLowerCase().includes(V.toLowerCase())});return t.jsxs("div",{className:"ml-56 mx-auto md:ml-0 md:w-full mt-3",children:[t.jsx("div",{className:"grid grid-cols-3 gap-4",children:t.jsx("div",{className:"col-span-3",children:t.jsx("div",{className:"rounded-md min-h-80 pl-2 md:pl-0",children:t.jsxs(ht,{children:[t.jsxs("div",{className:"py-2 flex flex-row justify-between",children:[t.jsx(vt,{className:"text-lg md:text-base md:hidden",children:"Tithes today"}),t.jsx("div",{className:"grid md:justify-end md:gap-2",children:t.jsx(le,{type:"text",placeholder:"Search by name, type, payment method, or notes",className:"w-52 placeholder-small md:w-[95%]",value:V,onChange:d=>b(d.target.value)})})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs(gt,{className:"w-full",children:[t.jsx(_e,{children:t.jsxs(ie,{children:[t.jsx(Q,{className:"text-center md:text-xs",children:"#"}),t.jsx(Q,{className:"text-center md:text-xs",children:"Photo"}),t.jsx(Q,{className:"md:text-xs",children:"Full Name"}),t.jsx(Q,{className:"md:text-xs",children:"Amount"}),t.jsx(Q,{className:"md:text-xs",children:"Type"}),t.jsx(Q,{className:"md:text-xs",children:"Payment Method"}),t.jsx(Q,{className:"md:text-xs",children:"Date Giving"}),t.jsx(Q,{className:"md:text-xs",children:"Notes"}),t.jsx(Q,{className:"text-right md:text-xs",children:"Action"})]})}),t.jsxs(Be,{children:[c.length===0&&t.jsx(ie,{children:t.jsx(U,{colSpan:9,className:"text-center",children:"No tithes found."})}),c.map((d,v)=>{var O,L;return t.jsxs(ie,{children:[t.jsx(U,{className:"md:text-xs",children:v+1}),t.jsx(U,{className:"flex justify-center md:justify-center item-center md:h-24 ",children:(O=d.member)!=null&&O.photo?t.jsx("img",{src:`https://jamctagoloan.xyz/${d==null?void 0:d.member.photo}`,alt:d.member.name,className:"rounded-full h-10 w-10"}):t.jsxs(ct,{children:[t.jsx(dt,{src:"https://github.com/shadcn.png"}),t.jsx(ut,{children:"CN"})]})}),t.jsx(U,{className:"md:text-xs",children:((L=d.member)==null?void 0:L.name)||"No name"}),t.jsx(U,{className:"md:text-xs",children:d.amount.toLocaleString("en-US",{style:"currency",currency:"PHP"})}),t.jsx(U,{className:"md:text-xs",children:d.type}),t.jsxs(U,{className:"md:text-xs",children:[d.payment_method==="Cash"&&t.jsx("span",{className:"inline-flex items-center rounded-md bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-green-600/20 ring-inset",children:"Cash"}),d.payment_method==="Gcash"&&t.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-blue-700/10 ring-inset",children:"Gcash"}),d.payment_method==="Bank transfer"&&t.jsx("span",{className:"inline-flex items-center rounded-md bg-purple-50 px-2 py-1 text-xs font-medium text-purple-700 ring-1 ring-purple-700/10 ring-inset",children:"Bank transfer"}),d.payment_method==="Others"&&t.jsx("span",{className:"inline-flex items-center rounded-md bg-[#1f2937] px-2 py-1 text-xs font-medium text-light",children:"Others"})]}),t.jsx(U,{className:"md:text-xs",children:yt(new Date(d.date_created),"MMMM dd, yyyy")}),t.jsx(U,{className:"md:text-xs",children:d.notes||"None"}),t.jsx(U,{className:"text-right",children:t.jsxs("div",{className:"flex justify-end md:flex-col md:gap-3 items-center gap-1",children:[t.jsx(zt,{tithe:d,editingTitheId:k,setEditingTitheId:R,handleEditTithe:g,index:v,setTithes:f}),t.jsx(te,{variant:"destructive",size:"icon",onClick:async()=>{if((await ne.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!"})).isConfirmed)try{await be.delete(`tithes/${d.id}`),$(),ne.fire("Deleted!","The tithes has been deleted.","success")}catch(Z){console.error("Error deleting tithes:",Z),ne.fire("Error!","Failed to delete tithes. Please try again.","error")}},className:"h-8 w-8 rounded-md hover:bg-red-500 hover:text-white focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:t.jsx(ve,{icon:lt})})]})})]},d.id)})]})]})})]})})})}),t.jsx(te,{onClick:()=>C(!0),className:"fixed bottom-20 right-4 w-12 h-12 rounded-full bg-primary text-white shadow-lg flex items-center justify-center",children:t.jsx(ve,{icon:Fe})}),t.jsx(qt,{isDialogOpen:x,setIsDialogOpen:C,rows:r,setRows:s,selectedMembers:e,setSelectedMembers:a,members:n,errors:u,handleSubmit:S,loading:D,isAddDisabled:h})]})}export{ia as default};
