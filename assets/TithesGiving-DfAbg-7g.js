import{R as ie,r as T,j as t,t as q,I as me,B as ae,F as he,C as tt,w as Oe,D as at,s as rt,E as nt}from"./index-DfZtaOmL.js";import{A as st,a as it,b as ot}from"./avatar-Dai5NIj6.js";import{C as lt,a as ct,T as dt,b as ut,c as pe,d as J,e as ft,f as W,j as mt}from"./card-9sRSyEEl.js";import{a as ye}from"./axios-1xl_CE3x.js";import{S as se}from"./sweetalert2.esm.all-B0Dix5B2.js";import{D as Ee,b as _e,c as Be,d as Re,e as Pe,f as Me,g as ht,a as vt}from"./dialog-CaYJVhE8.js";import{S as ce,a as de,b as ue,c as fe,d as K}from"./select-DCjC36XI.js";import{f as gt}from"./format-CBpsKyOP.js";import"./index-QW84Iduc.js";import"./index-CkNby75E.js";function ke(e,a){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&a.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(e);n<s.length;n++)a.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(r[s[n]]=e[s[n]]);return r}var ve;(function(e){e.event="event",e.props="prop"})(ve||(ve={}));function te(){}function xt(e){var a,r=void 0;return function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return a&&s.length===a.length&&s.every(function(i,c){return i===a[c]})||(a=s,r=e.apply(void 0,s)),r}}function ge(e){return!!(e||"").match(/\d/)}function oe(e){return e==null}function pt(e){return typeof e=="number"&&isNaN(e)}function Le(e){return oe(e)||pt(e)||typeof e=="number"&&!isFinite(e)}function Ge(e){return e.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")}function yt(e){switch(e){case"lakh":return/(\d+?)(?=(\d\d)+(\d)(?!\d))(\.\d+)?/g;case"wan":return/(\d)(?=(\d{4})+(?!\d))/g;case"thousand":default:return/(\d)(?=(\d{3})+(?!\d))/g}}function bt(e,a,r){var s=yt(r),n=e.search(/[1-9]/);return n=n===-1?e.length:n,e.substring(0,n)+e.substring(n,e.length).replace(s,"$1"+a)}function jt(e){var a=T.useRef(e);a.current=e;var r=T.useRef(function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return a.current.apply(a,s)});return r.current}function De(e,a){a===void 0&&(a=!0);var r=e[0]==="-",s=r&&a;e=e.replace("-","");var n=e.split("."),i=n[0],c=n[1]||"";return{beforeDecimal:i,afterDecimal:c,hasNegation:r,addNegation:s}}function Nt(e){if(!e)return e;var a=e[0]==="-";a&&(e=e.substring(1,e.length));var r=e.split("."),s=r[0].replace(/^0+/,"")||"0",n=r[1]||"";return(a?"-":"")+s+(n?"."+n:"")}function $e(e,a,r){for(var s="",n=r?"0":"",i=0;i<=a-1;i++)s+=e[i]||n;return s}function Te(e,a){return Array(a+1).join(e)}function He(e){var a=e+"",r=a[0]==="-"?"-":"";r&&(a=a.substring(1));var s=a.split(/[eE]/g),n=s[0],i=s[1];if(i=Number(i),!i)return r+n;n=n.replace(".","");var c=1+i,j=n.length;return c<0?n="0."+Te("0",Math.abs(c))+n:c>=j?n=n+Te("0",c-j):n=(n.substring(0,c)||"0")+"."+n.substring(c),r+n}function Ie(e,a,r){if(["","-"].indexOf(e)!==-1)return e;var s=(e.indexOf(".")!==-1||r)&&a,n=De(e),i=n.beforeDecimal,c=n.afterDecimal,j=n.hasNegation,C=parseFloat("0."+(c||"0")),S=c.length<=a?"0."+c:C.toFixed(a),m=S.split("."),v=i;i&&Number(m[0])&&(v=i.split("").reverse().reduce(function(A,V,y){return A.length>y?(Number(A[0])+Number(V)).toString()+A.substring(1,A.length):V+A},m[0]));var h=$e(m[1]||"",a,r),D=j?"-":"",x=s?".":"";return""+D+v+x+h}function re(e,a){if(e.value=e.value,e!==null){if(e.createTextRange){var r=e.createTextRange();return r.move("character",a),r.select(),!0}return e.selectionStart||e.selectionStart===0?(e.focus(),e.setSelectionRange(a,a),!0):(e.focus(),!1)}}var Ke=xt(function(e,a){for(var r=0,s=0,n=e.length,i=a.length;e[r]===a[r]&&r<n;)r++;for(;e[n-1-s]===a[i-1-s]&&i-s>r&&n-s>r;)s++;return{from:{start:r,end:n-s},to:{start:r,end:i-s}}}),St=function(e,a){var r=Math.min(e.selectionStart,a);return{from:{start:r,end:e.selectionEnd},to:{start:r,end:a}}};function wt(e,a,r){return Math.min(Math.max(e,a),r)}function Ce(e){return Math.max(e.selectionStart,e.selectionEnd)}function Ct(){return typeof navigator<"u"&&!(navigator.platform&&/iPhone|iPod/.test(navigator.platform))}function Dt(e){return{from:{start:0,end:0},to:{start:0,end:e.length},lastValue:""}}function Vt(e){var a=e.currentValue,r=e.formattedValue,s=e.currentValueIndex,n=e.formattedValueIndex;return a[s]===r[n]}function Tt(e,a,r,s,n,i,c){c===void 0&&(c=Vt);var j=n.findIndex(function($){return $}),C=e.slice(0,j);!a&&!r.startsWith(C)&&(a=C,r=C+r,s=s+C.length);for(var S=r.length,m=e.length,v={},h=new Array(S),D=0;D<S;D++){h[D]=-1;for(var x=0,A=m;x<A;x++){var V=c({currentValue:r,lastValue:a,formattedValue:e,currentValueIndex:D,formattedValueIndex:x});if(V&&v[x]!==!0){h[D]=x,v[x]=!0;break}}}for(var y=s;y<S&&(h[y]===-1||!i(r[y]));)y++;var P=y===S||h[y]===-1?m:h[y];for(y=s-1;y>0&&h[y]===-1;)y--;var R=y===-1||h[y]===-1?0:h[y]+1;return R>P?P:s-R<P-s?R:P}function Ae(e,a,r,s){var n=e.length;if(a=wt(a,0,n),s==="left"){for(;a>=0&&!r[a];)a--;a===-1&&(a=r.indexOf(!0))}else{for(;a<=n&&!r[a];)a++;a>n&&(a=r.lastIndexOf(!0))}return a===-1&&(a=n),a}function It(e){for(var a=Array.from({length:e.length+1}).map(function(){return!0}),r=0,s=a.length;r<s;r++)a[r]=!!(ge(e[r])||ge(e[r-1]));return a}function Ue(e,a,r,s,n,i){i===void 0&&(i=te);var c=jt(function(x,A){var V,y;return Le(x)?(y="",V=""):typeof x=="number"||A?(y=typeof x=="number"?He(x):x,V=s(y)):(y=n(x,void 0),V=s(y)),{formattedValue:V,numAsString:y}}),j=T.useState(function(){return c(oe(e)?a:e,r)}),C=j[0],S=j[1],m=function(x,A){x.formattedValue!==C.formattedValue&&S({formattedValue:x.formattedValue,numAsString:x.value}),i(x,A)},v=e,h=r;oe(e)&&(v=C.numAsString,h=!0);var D=c(v,h);return T.useMemo(function(){S(D)},[D.formattedValue]),[C,m]}function At(e){return e.replace(/[^0-9]/g,"")}function Ft(e){return e}function Ot(e){var a=e.type;a===void 0&&(a="text");var r=e.displayType;r===void 0&&(r="input");var s=e.customInput,n=e.renderText,i=e.getInputRef,c=e.format;c===void 0&&(c=Ft);var j=e.removeFormatting;j===void 0&&(j=At);var C=e.defaultValue,S=e.valueIsNumericString,m=e.onValueChange,v=e.isAllowed,h=e.onChange;h===void 0&&(h=te);var D=e.onKeyDown;D===void 0&&(D=te);var x=e.onMouseUp;x===void 0&&(x=te);var A=e.onFocus;A===void 0&&(A=te);var V=e.onBlur;V===void 0&&(V=te);var y=e.value,P=e.getCaretBoundary;P===void 0&&(P=It);var R=e.isValidInputCharacter;R===void 0&&(R=ge);var $=e.isCharacterSame,H=ke(e,["type","displayType","customInput","renderText","getInputRef","format","removeFormatting","defaultValue","valueIsNumericString","onValueChange","isAllowed","onChange","onKeyDown","onMouseUp","onFocus","onBlur","value","getCaretBoundary","isValidInputCharacter","isCharacterSame"]),z=Ue(y,C,!!S,c,j,m),p=z[0],o=p.formattedValue,g=p.numAsString,d=z[1],f=T.useRef(),F=T.useRef({formattedValue:o,numAsString:g}),L=function(l,u){F.current={formattedValue:l.formattedValue,numAsString:l.value},d(l,u)},Q=T.useState(!1),Z=Q[0],w=Q[1],b=T.useRef(null),O=T.useRef({setCaretTimeout:null,focusTimeout:null});T.useEffect(function(){return w(!0),function(){clearTimeout(O.current.setCaretTimeout),clearTimeout(O.current.focusTimeout)}},[]);var M=c,k=function(l,u){var N=parseFloat(u);return{formattedValue:l,value:u,floatValue:isNaN(N)?void 0:N}},B=function(l,u,N){l.selectionStart===0&&l.selectionEnd===l.value.length||(re(l,u),O.current.setCaretTimeout=setTimeout(function(){l.value===N&&l.selectionStart!==u&&re(l,u)},0))},G=function(l,u,N){return Ae(l,u,P(l),N)},ne=function(l,u,N){var E=P(u),U=Tt(u,o,l,N,E,R,$);return U=Ae(u,U,E),U},je=function(l){var u=l.formattedValue;u===void 0&&(u="");var N=l.input,E=l.source,U=l.event,_=l.numAsString,I;if(N){var Y=l.inputValue||N.value,X=Ce(N);N.value=u,I=ne(Y,u,X),I!==void 0&&B(N,I,u)}u!==o&&L(k(u,_),{event:U,source:E})};T.useEffect(function(){var l=F.current,u=l.formattedValue,N=l.numAsString;(o!==u||g!==N)&&L(k(o,g),{event:void 0,source:ve.props})},[o,g]);var le=b.current?Ce(b.current):void 0,xe=typeof window<"u"?T.useLayoutEffect:T.useEffect;xe(function(){var l=b.current;if(o!==F.current.formattedValue&&l){var u=ne(F.current.formattedValue,o,le);l.value=o,B(l,u,o)}},[o]);var Ne=function(l,u,N){var E=u.target,U=f.current?St(f.current,E.selectionEnd):Ke(o,l),_=Object.assign(Object.assign({},U),{lastValue:o}),I=j(l,_),Y=M(I);if(I=j(Y,void 0),v&&!v(k(Y,I))){var X=u.target,ee=Ce(X),we=ne(l,o,ee);return X.value=o,B(X,we,o),!1}return je({formattedValue:Y,numAsString:I,inputValue:l,event:u,source:N,input:u.target}),!0},Se=function(l,u){u===void 0&&(u=0);var N=l.selectionStart,E=l.selectionEnd;f.current={selectionStart:N,selectionEnd:E+u}},ze=function(l){var u=l.target,N=u.value,E=Ne(N,l,ve.event);E&&h(l),f.current=void 0},Ze=function(l){var u=l.target,N=l.key,E=u.selectionStart,U=u.selectionEnd,_=u.value;_===void 0&&(_="");var I;N==="ArrowLeft"||N==="Backspace"?I=Math.max(E-1,0):N==="ArrowRight"?I=Math.min(E+1,_.length):N==="Delete"&&(I=E);var Y=0;N==="Delete"&&E===U&&(Y=1);var X=N==="ArrowLeft"||N==="ArrowRight";if(I===void 0||E!==U&&!X){D(l),Se(u,Y);return}var ee=I;if(X){var we=N==="ArrowLeft"?"left":"right";ee=G(_,I,we),ee!==I&&l.preventDefault()}else N==="Delete"&&!R(_[I])?ee=G(_,I,"right"):N==="Backspace"&&!R(_[I])&&(ee=G(_,I,"left"));ee!==I&&B(u,ee,_),D(l),Se(u,Y)},Qe=function(l){var u=l.target,N=function(){var E=u.selectionStart,U=u.selectionEnd,_=u.value;if(_===void 0&&(_=""),E===U){var I=G(_,E);I!==E&&B(u,I,_)}};N(),requestAnimationFrame(function(){N()}),x(l),Se(u)},Ye=function(l){l.persist&&l.persist();var u=l.target,N=l.currentTarget;b.current=u,O.current.focusTimeout=setTimeout(function(){var E=u.selectionStart,U=u.selectionEnd,_=u.value;_===void 0&&(_="");var I=G(_,E);I!==E&&!(E===0&&U===_.length)&&B(u,I,_),A(Object.assign(Object.assign({},l),{currentTarget:N}))},0)},Je=function(l){b.current=null,clearTimeout(O.current.focusTimeout),clearTimeout(O.current.setCaretTimeout),V(l)},Xe=Z&&Ct()?"numeric":void 0,Ve=Object.assign({inputMode:Xe},H,{type:a,value:o,onChange:ze,onKeyDown:Ze,onMouseUp:Qe,onFocus:Ye,onBlur:Je});if(r==="text")return n?ie.createElement(ie.Fragment,null,n(o,H)||null):ie.createElement("span",Object.assign({},H,{ref:i}),o);if(s){var et=s;return ie.createElement(et,Object.assign({},Ve,{ref:i}))}return ie.createElement("input",Object.assign({},Ve,{ref:i}))}function Fe(e,a){var r=a.decimalScale,s=a.fixedDecimalScale,n=a.prefix;n===void 0&&(n="");var i=a.suffix;i===void 0&&(i="");var c=a.allowNegative,j=a.thousandsGroupStyle;if(j===void 0&&(j="thousand"),e===""||e==="-")return e;var C=be(a),S=C.thousandSeparator,m=C.decimalSeparator,v=r!==0&&e.indexOf(".")!==-1||r&&s,h=De(e,c),D=h.beforeDecimal,x=h.afterDecimal,A=h.addNegation;return r!==void 0&&(x=$e(x,r,!!s)),S&&(D=bt(D,S,j)),n&&(D=n+D),i&&(x=x+i),A&&(D="-"+D),e=D+(v&&m||"")+x,e}function be(e){var a=e.decimalSeparator;a===void 0&&(a=".");var r=e.thousandSeparator,s=e.allowedDecimalSeparators;return r===!0&&(r=","),s||(s=[a,"."]),{decimalSeparator:a,thousandSeparator:r,allowedDecimalSeparators:s}}function Et(e,a){e===void 0&&(e="");var r=new RegExp("(-)"),s=new RegExp("(-)(.)*(-)"),n=r.test(e),i=s.test(e);return e=e.replace(/-/g,""),n&&!i&&a&&(e="-"+e),e}function _t(e,a){return new RegExp("(^-)|[0-9]|"+Ge(e),"g")}function Bt(e,a,r){return e===""?!0:!(a!=null&&a.match(/\d/))&&!(r!=null&&r.match(/\d/))&&typeof e=="string"&&!isNaN(Number(e))}function Rt(e,a,r){var s;a===void 0&&(a=Dt(e));var n=r.allowNegative,i=r.prefix;i===void 0&&(i="");var c=r.suffix;c===void 0&&(c="");var j=r.decimalScale,C=a.from,S=a.to,m=S.start,v=S.end,h=be(r),D=h.allowedDecimalSeparators,x=h.decimalSeparator,A=e[v]===x;if(ge(e)&&(e===i||e===c)&&a.lastValue==="")return e;if(v-m===1&&D.indexOf(e[m])!==-1){var V=j===0?"":x;e=e.substring(0,m)+V+e.substring(m+1,e.length)}var y=function(b,O,M){var k=!1,B=!1;i.startsWith("-")?k=!1:b.startsWith("--")?(k=!1,B=!0):c.startsWith("-")&&b.length===c.length?k=!1:b[0]==="-"&&(k=!0);var G=k?1:0;return B&&(G=2),G&&(b=b.substring(G),O-=G,M-=G),{value:b,start:O,end:M,hasNegation:k}},P=y(e,m,v),R=P.hasNegation;s=P,e=s.value,m=s.start,v=s.end;var $=y(a.lastValue,C.start,C.end),H=$.start,z=$.end,p=$.value,o=e.substring(m,v);e.length&&p.length&&(H>p.length-c.length||z<i.length)&&!(o&&c.startsWith(o))&&(e=p);var g=0;e.startsWith(i)?g+=i.length:m<i.length&&(g=m),e=e.substring(g),v-=g;var d=e.length,f=e.length-c.length;e.endsWith(c)?d=f:(v>f||v>e.length-c.length)&&(d=v),e=e.substring(0,d),e=Et(R?"-"+e:e,n),e=(e.match(_t(x))||[]).join("");var F=e.indexOf(x);e=e.replace(new RegExp(Ge(x),"g"),function(b,O){return O===F?".":""});var L=De(e,n),Q=L.beforeDecimal,Z=L.afterDecimal,w=L.addNegation;return S.end-S.start<C.end-C.start&&Q===""&&A&&!parseFloat(Z)&&(e=w?"-":""),e}function Pt(e,a){var r=a.prefix;r===void 0&&(r="");var s=a.suffix;s===void 0&&(s="");var n=Array.from({length:e.length+1}).map(function(){return!0}),i=e[0]==="-";n.fill(!1,0,r.length+(i?1:0));var c=e.length;return n.fill(!1,c-s.length+1,c+1),n}function Mt(e){var a=be(e),r=a.thousandSeparator,s=a.decimalSeparator,n=e.prefix;n===void 0&&(n="");var i=e.allowNegative;if(i===void 0&&(i=!0),r===s)throw new Error(`
        Decimal separator can't be same as thousand separator.
        thousandSeparator: `+r+` (thousandSeparator = {true} is same as thousandSeparator = ",")
        decimalSeparator: `+s+` (default value for decimalSeparator is .)
     `);return n.startsWith("-")&&i&&(console.error(`
      Prefix can't start with '-' when allowNegative is true.
      prefix: `+n+`
      allowNegative: `+i+`
    `),i=!1),Object.assign(Object.assign({},e),{allowNegative:i})}function kt(e){e=Mt(e),e.decimalSeparator,e.allowedDecimalSeparators,e.thousandsGroupStyle;var a=e.suffix,r=e.allowNegative,s=e.allowLeadingZeros,n=e.onKeyDown;n===void 0&&(n=te);var i=e.onBlur;i===void 0&&(i=te);var c=e.thousandSeparator,j=e.decimalScale,C=e.fixedDecimalScale,S=e.prefix;S===void 0&&(S="");var m=e.defaultValue,v=e.value,h=e.valueIsNumericString,D=e.onValueChange,x=ke(e,["decimalSeparator","allowedDecimalSeparators","thousandsGroupStyle","suffix","allowNegative","allowLeadingZeros","onKeyDown","onBlur","thousandSeparator","decimalScale","fixedDecimalScale","prefix","defaultValue","value","valueIsNumericString","onValueChange"]),A=be(e),V=A.decimalSeparator,y=A.allowedDecimalSeparators,P=function(w){return Fe(w,e)},R=function(w,b){return Rt(w,b,e)},$=oe(v)?m:v,H=h??Bt($,S,a);oe(v)?oe(m)||(H=H||typeof m=="number"):H=H||typeof v=="number";var z=function(w){return Le(w)?w:(typeof w=="number"&&(w=He(w)),H&&typeof j=="number"?Ie(w,j,!!C):w)},p=Ue(z(v),z(m),!!H,P,R,D),o=p[0],g=o.numAsString,d=o.formattedValue,f=p[1],F=function(w){var b=w.target,O=w.key,M=b.selectionStart,k=b.selectionEnd,B=b.value;if(B===void 0&&(B=""),(O==="Backspace"||O==="Delete")&&k<S.length){w.preventDefault();return}if(M!==k){n(w);return}O==="Backspace"&&B[0]==="-"&&M===S.length+1&&r&&re(b,1),j&&C&&(O==="Backspace"&&B[M-1]===V?(re(b,M-1),w.preventDefault()):O==="Delete"&&B[M]===V&&w.preventDefault()),y!=null&&y.includes(O)&&B[M]===V&&re(b,M+1);var G=c===!0?",":c;O==="Backspace"&&B[M-1]===G&&re(b,M-1),O==="Delete"&&B[M]===G&&re(b,M+1),n(w)},L=function(w){var b=g;if(b.match(/\d/g)||(b=""),s||(b=Nt(b)),C&&j&&(b=Ie(b,j,C)),b!==g){var O=Fe(b,e);f({formattedValue:O,value:b,floatValue:parseFloat(b)},{event:w,source:ve.event})}i(w)},Q=function(w){return w===V?!0:ge(w)},Z=function(w){var b=w.currentValue,O=w.lastValue,M=w.formattedValue,k=w.currentValueIndex,B=w.formattedValueIndex,G=b[k],ne=M[B],je=Ke(O,b),le=je.to,xe=function(Ne){return R(Ne).indexOf(".")+S.length};return v===0&&C&&j&&b[le.start]===V&&xe(b)<k&&xe(M)>B?!1:k>=le.start&&k<le.end&&y&&y.includes(G)&&ne===V?!0:G===ne};return Object.assign(Object.assign({},x),{value:d,valueIsNumericString:!1,isValidInputCharacter:Q,isCharacterSame:Z,onValueChange:f,format:P,removeFormatting:R,getCaretBoundary:function(w){return Pt(w,e)},onKeyDown:F,onBlur:L})}function We(e){var a=kt(e);return ie.createElement(Ot,Object.assign({},a))}const Lt=({isDialogOpen:e,setIsDialogOpen:a,rows:r,setRows:s,selectedMembers:n,setSelectedMembers:i,members:c,errors:j,handleSubmit:C,loading:S,isAddDisabled:m})=>{const v=(p,o)=>{i(g=>({...g,[p]:o}))},h=(p,o)=>{const g=[...r];g[p].type=o,s(g)},D=(p,o)=>{const g=[...r];g[p].paymentMethod=o,s(g)},x=(p,o)=>{const g=[...r];g[p].amount=o,s(g)},A=(p,o)=>{const g=[...r];g[p].notes=o,s(g)},V=(p,o)=>{const g=[...r];g[p].date_created=o,s(g)},y=()=>new Date().toISOString().split("T")[0],P=()=>{s(p=>[...p,{type:"Tithes and Offering",paymentMethod:"Cash",amount:"",notes:"",date_created:y()}])},R=p=>{s(o=>o.filter((g,d)=>d!==p)),i(o=>{const g={...o};return delete g[p],g})},$=p=>Object.values(n).includes(p),H=()=>{const p=y(),o=r.map(g=>({member_id:null,type:g.type,amount:g.amount,payment_method:g.paymentMethod,date_created:g.date_created||p,notes:g.notes}));console.log("Submitting data:",o),C({tithes:o})},z=T.useMemo(()=>r.reduce((p,o)=>p+parseFloat(o.amount||"0"),0).toFixed(2),[r]);return t.jsx(Ee,{open:e,onOpenChange:a,children:t.jsxs(_e,{className:"overflow-auto h-screen w-[98%] max-w-6xl mx-auto backdrop-blur-sm",children:[t.jsxs(Be,{className:"text-start",children:[t.jsx(Re,{children:"Add Tithes & Offering"}),t.jsx(Pe,{children:r.map((p,o)=>{var g,d;return t.jsxs("div",{className:"mt-5 mb-5 p-7 border border-b-4 border-primary rounded-lg flex flex-wrap gap-3 relative",children:[t.jsxs("div",{className:"flex-1 min-w-[200px]",children:[t.jsx(q,{htmlFor:"date_created",children:"Date Created"}),t.jsx(me,{type:"date",value:p.date_created||y(),onChange:f=>V(o,f.target.value)})]}),t.jsxs("div",{className:"flex-1 min-w-[200px]",children:[t.jsxs(q,{htmlFor:"member",children:["Member ",t.jsx("span",{className:"text-gray-500 text-[11px]",children:"(If no name, it's okay to leave it blank)"})]}),t.jsxs(ce,{value:n[o]||"",onValueChange:f=>v(o,f),children:[t.jsx(de,{children:t.jsx(ue,{placeholder:"Select a member",defaultValue:n[o]?"":"No name"})}),t.jsx(fe,{className:"overflow-auto max-h-[200px]",children:c.filter(f=>!$(f.id)||n[o]===f.id).map(f=>t.jsx(K,{value:f.id,className:"cursor-pointer hover:bg-gray-200",children:f.name},f.id))})]}),((g=j[o])==null?void 0:g.member)&&t.jsx("span",{className:"text-red-500 text-xs",children:j[o].member})]}),t.jsxs("div",{className:"flex-1 min-w-[200px]",children:[t.jsx(q,{htmlFor:"type",children:"Type:"}),t.jsxs(ce,{value:p.type,onValueChange:f=>h(o,f),children:[t.jsx(de,{children:t.jsx(ue,{placeholder:"Select a type"})}),t.jsxs(fe,{children:[t.jsx(K,{value:"Tithes and Offering",className:"cursor-pointer hover:bg-gray-200",children:"Tithes and Offering"}),t.jsx(K,{value:"Help fund",className:"cursor-pointer hover:bg-gray-200",children:"Help Fund"}),t.jsx(K,{value:"Solomon Pledge",className:"cursor-pointer hover:bg-gray-200",children:"Solomon Pledge"}),t.jsx(K,{value:"Others",className:"cursor-pointer hover:bg-gray-200",children:"Others..."})]})]})]}),t.jsxs("div",{className:"flex-1 min-w-[200px]",children:[t.jsxs(q,{htmlFor:"amount",children:["Amount (PHP) ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx(We,{thousandSeparator:!0,prefix:"₱ ",decimalScale:2,fixedDecimalScale:!0,allowNegative:!1,value:p.amount,onValueChange:f=>{const{value:F}=f;x(o,F)},className:"flex h-9 w-full rounded-md border border-primary bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",placeholder:"0.00"}),((d=j[o])==null?void 0:d.amount)&&t.jsx("span",{className:"text-red-500 text-xs",children:j[o].amount})]}),t.jsxs("div",{className:"flex-1 min-w-[200px]",children:[t.jsx(q,{htmlFor:"payment",children:"Payment Method"}),t.jsxs(ce,{value:p.paymentMethod,onValueChange:f=>D(o,f),children:[t.jsx(de,{children:t.jsx(ue,{placeholder:"Select a payment method"})}),t.jsxs(fe,{children:[t.jsx(K,{value:"Cash",className:"cursor-pointer hover:bg-gray-200",children:"Cash"}),t.jsx(K,{value:"Gcash",className:"cursor-pointer hover:bg-gray-200",children:"Gcash"}),t.jsx(K,{value:"Bank transfer",className:"cursor-pointer hover:bg-gray-200",children:"Bank Transfer"}),t.jsx(K,{value:"Others",className:"cursor-pointer hover:bg-gray-200",children:"Others..."})]})]})]}),t.jsxs("div",{className:"flex-1 min-w-[200px]",children:[t.jsx(q,{htmlFor:"notes",children:"Notes (Optional)"}),t.jsx(me,{placeholder:"Type your notes here...",value:p.notes,onChange:f=>A(o,f.target.value)})]}),o>0&&t.jsx(ae,{type:"button",className:"bg-red-500 hover:bg-red-400 h-8 w-8 m-2 rounded-full text-white text-sm absolute top-0 right-0",onClick:()=>R(o),children:t.jsx(he,{icon:tt})})]},o)})}),t.jsx("div",{className:"pb-10 flex justify-end items-center",children:t.jsxs(ae,{className:"bg-blue-500 hover:bg-blue-400 ",onClick:P,disabled:m,children:[t.jsx(he,{icon:Oe,className:"mr-2"})," Add Tithers"]})})]}),t.jsx(Me,{children:t.jsxs("div",{className:"flex items-center justify-between gap-2",children:[t.jsxs("div",{children:["Total Amount: ",t.jsxs("span",{className:"font-bold",children:["₱ ",z]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ht,{asChild:!0,children:t.jsx(ae,{type:"button",className:"bg-red-500 hover:bg-red-400",disabled:S,children:"Cancel"})}),t.jsx(ae,{type:"submit",className:"bg-blue-500 hover:bg-blue-400",onClick:H,disabled:S,children:S?t.jsxs(t.Fragment,{children:[t.jsx("span",{children:"Submitting..."}),t.jsx("span",{className:"animate-spin border-2 border-white border-t-transparent rounded-full w-4 h-4 ml-2"})]}):t.jsx(t.Fragment,{children:"Submit"})})]})]})})]})})},qe=T.forwardRef(({className:e,...a},r)=>t.jsx("textarea",{className:at("flex min-h-[60px] w-full rounded-md border border-primary bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...a}));qe.displayName="Textarea";function Gt({tithe:e,editingTitheId:a,setEditingTitheId:r,handleEditTithe:s,index:n,setTithes:i}){var S;const[c,j]=T.useState({}),C=()=>{const m={};(!e.amount||parseFloat(e.amount)===0)&&(m.amount="Amount must be greater than zero."),e.type||(m.type="Type is required."),e.payment_method||(m.payment_method="Payment method is required."),j(m),Object.keys(m).length===0&&s(e)};return t.jsxs(Ee,{open:a===e.id,onOpenChange:m=>{!m&&(e.amount===""||parseFloat(e.amount)===0)||r(m?e.id:null)},children:[t.jsx(vt,{asChild:!0,children:t.jsx(ae,{className:`text-white w-7 h-7 rounded-md \r
            bg-green-500 hover:bg-green-400`,children:t.jsx(he,{icon:rt})})}),t.jsxs(_e,{children:[t.jsxs(Be,{className:"text-start",children:[t.jsx(Re,{children:"Edit tithes"}),t.jsxs(Pe,{children:["Make changes to your tithes here. Click save when you're done.",t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(q,{htmlFor:"name",className:"text-start",children:"Fullname"}),t.jsx(me,{value:((S=e.member)==null?void 0:S.name)||"No name",readOnly:!0,className:"col-span-3 cursor-not-allowed"})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(q,{htmlFor:"date_created",className:"text-start",children:"Date created"}),t.jsx(me,{value:e.date_created,type:"date",onChange:m=>i(v=>{const h=[...v];return h[n].date_created=m.target.value,h}),className:"col-span-3"})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(q,{htmlFor:"amount",className:"text-start",children:"Amount"}),t.jsx(We,{thousandSeparator:!0,prefix:"₱ ",decimalScale:2,fixedDecimalScale:!0,allowNegative:!1,value:e.amount,onValueChange:m=>i(v=>{const h=[...v];return h[n].amount=m.value,h}),className:"flex h-9 w-full col-span-3 rounded-md border border-primary bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",placeholder:"0.00"}),c.amount&&t.jsx("span",{className:"text-red-500 text-xs col-span-3",children:c.amount})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(q,{htmlFor:"type",className:"text-start",children:"Type"}),t.jsxs(ce,{value:e.type,onValueChange:m=>i(v=>{const h=[...v];return h[n].type=m,h}),children:[t.jsx(de,{className:"col-span-3",children:t.jsx(ue,{placeholder:"Select a type"})}),t.jsxs(fe,{children:[t.jsx(K,{value:"Tithes and Offering",children:"Tithes and Offering"}),t.jsx(K,{value:"Help fund",children:"Help fund"}),t.jsx(K,{value:"Solomon Pledge",children:"Solomon Pledge"})]})]}),c.type&&t.jsx("span",{className:"text-red-500 text-xs col-span-3",children:c.type})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(q,{htmlFor:"paymentMethod",className:"text-start",children:"Payment method"}),t.jsxs(ce,{value:e.payment_method,onValueChange:m=>i(v=>{const h=[...v];return h[n].payment_method=m,h}),children:[t.jsx(de,{className:"col-span-3",children:t.jsx(ue,{placeholder:"Select a payment method"})}),t.jsxs(fe,{children:[t.jsx(K,{value:"Cash",children:"Cash"}),t.jsx(K,{value:"Gcash",children:"Gcash"}),t.jsx(K,{value:"Bank transfer",children:"Bank transfer"}),t.jsx(K,{value:"Others",children:"Others"})]})]}),c.payment_method&&t.jsx("span",{className:"text-red-500 text-xs col-span-3",children:c.payment_method})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(q,{htmlFor:"notes",className:"text-start",children:"Notes"}),t.jsx(qe,{value:e.notes,onChange:m=>i(v=>{const h=[...v];return h[n].notes=m.target.value,h}),className:"col-span-3",placeholder:"Add notes"})]})]})]})]}),t.jsx(Me,{children:t.jsx(ae,{type:"button",onClick:C,children:"Save changes"})})]})]})}function Jt(){const[e,a]=T.useState({}),[r,s]=T.useState([{type:"Tithes and Offering",paymentMethod:"Cash",amount:"",notes:""}]),[n,i]=T.useState([]),[c,j]=T.useState([]),[C,S]=T.useState(!1),[m,v]=T.useState(!1),[h,D]=T.useState(!1),[x,A]=T.useState({}),[V,y]=T.useState(""),[P,R]=T.useState(null);T.useEffect(()=>{$()},[]);const $=async()=>{try{const d=await ye.get("tithes",{headers:{"Content-Type":"application/json"}});i(d.data.listOfMembers),j(d.data.tithes)}catch(d){console.error("Error fetching members:",d)}},H=()=>{const d={};return r.forEach((f,F)=>{(!f.amount||parseFloat(f.amount)<=0)&&(d[F]={...d[F],amount:"Amount must be greater than 0"})}),A(d),Object.keys(d).length===0},z=async()=>{if(m||!H())return;v(!0),D(!0);const d=r.map((f,F)=>({member_id:e[F]||null,type:f.type,amount:parseFloat(f.amount),payment_method:f.paymentMethod,notes:f.notes}));try{const f=await ye.post("tithes",{tithes:d},{headers:{"Content-Type":"application/json"}});s([{type:"Tithes and Offering",paymentMethod:"Cash",amount:"",notes:""}]),a({}),S(!1),$();const F=f.data.message,L=F.includes("Note: Some members already had tithes recorded today.");se.fire({icon:L?"warning":"success",title:L?"Partial Success":"Success",text:F,timer:3e3,showConfirmButton:!1,timerProgressBar:!0})}catch(f){console.error("Error submitting tithes:",f)}finally{v(!1),D(!1)}},p=async d=>{try{const f=await ye.put(`tithes/${d.id}`,d,{headers:{"Content-Type":"application/json"}});$(),R(null);const F=f.data.message,L=F.includes("Note: Some members already had tithes recorded today.");se.fire({icon:L?"warning":"success",title:L?"Partial Success":"Success",text:F,timer:2e3,showConfirmButton:!1}),j(Q=>Q.map(Z=>Z.id===d.id?f.data.tithes:Z))}catch(f){console.error("Error updating tithes:",f),se.fire({icon:"error",title:"Error",text:"Failed to update tithes. Please try again."})}},o=c.filter(d=>{var f;return(((f=d.member)==null?void 0:f.name)||"").toLowerCase().includes(V.toLowerCase())||d.type.toLowerCase().includes(V.toLowerCase())||d.payment_method.toLowerCase().includes(V.toLowerCase())||(d.notes||"").toLowerCase().includes(V.toLowerCase())}),g=T.useMemo(()=>o.reduce((d,f)=>d+parseFloat(f.amount||"0"),0).toFixed(2),[o]);return t.jsxs("div",{className:"ml-56 mx-auto md:ml-0 md:w-full mt-3",children:[t.jsx("div",{className:"grid grid-cols-3 gap-4",children:t.jsx("div",{className:"col-span-3",children:t.jsx("div",{className:"rounded-md min-h-80 pl-2 md:pl-0",children:t.jsxs(lt,{children:[t.jsxs("div",{className:"py-2 flex flex-row justify-between",children:[t.jsx(ct,{className:"text-lg md:text-base md:hidden",children:"Tithes today"}),t.jsx("div",{className:"grid md:justify-end md:gap-2",children:t.jsx(me,{type:"text",placeholder:"Search by name, type, payment method, or notes",className:"w-52 placeholder-small md:w-[95%]",value:V,onChange:d=>y(d.target.value)})})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs(dt,{className:"w-full",children:[t.jsx(ut,{children:t.jsxs(pe,{children:[t.jsx(J,{className:"text-center md:text-xs",children:"#"}),t.jsx(J,{className:"text-center md:text-xs",children:"Photo"}),t.jsx(J,{className:"md:text-xs",children:"Full Name"}),t.jsx(J,{className:"md:text-xs",children:"Amount"}),t.jsx(J,{className:"md:text-xs",children:"Type"}),t.jsx(J,{className:"md:text-xs",children:"Payment Method"}),t.jsx(J,{className:"md:text-xs",children:"Date Giving"}),t.jsx(J,{className:"md:text-xs",children:"Notes"}),t.jsx(J,{className:"text-right md:text-xs",children:"Action"})]})}),t.jsxs(ft,{children:[o.length===0&&t.jsx(pe,{children:t.jsx(W,{colSpan:9,className:"text-center",children:"No tithes found."})}),o.map((d,f)=>{var F,L;return t.jsxs(pe,{children:[t.jsx(W,{className:"md:text-xs",children:f+1}),t.jsx(W,{className:"flex justify-center md:justify-center item-center md:h-24 ",children:(F=d.member)!=null&&F.photo?t.jsx("img",{src:`https://jamctagoloan.xyz/${d==null?void 0:d.member.photo}`,alt:d.member.name,className:"rounded-full h-10 w-10"}):t.jsxs(st,{children:[t.jsx(it,{src:"https://github.com/shadcn.png"}),t.jsx(ot,{children:"CN"})]})}),t.jsx(W,{className:"md:text-xs",children:((L=d.member)==null?void 0:L.name)||"No Name"}),t.jsx(W,{className:"md:text-xs",children:d.amount.toLocaleString("en-US",{style:"currency",currency:"PHP"})}),t.jsx(W,{className:"md:text-xs",children:d.type}),t.jsxs(W,{className:"md:text-xs",children:[d.payment_method==="Cash"&&t.jsx("span",{className:"inline-flex items-center rounded-md bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-green-600/20 ring-inset",children:"Cash"}),d.payment_method==="Gcash"&&t.jsx("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-blue-700/10 ring-inset",children:"Gcash"}),d.payment_method==="Bank transfer"&&t.jsx("span",{className:"inline-flex items-center rounded-md bg-purple-50 px-2 py-1 text-xs font-medium text-purple-700 ring-1 ring-purple-700/10 ring-inset",children:"Bank transfer"}),d.payment_method==="Others"&&t.jsx("span",{className:"inline-flex items-center rounded-md bg-[#1f2937] px-2 py-1 text-xs font-medium text-light",children:"Others"})]}),t.jsx(W,{className:"md:text-xs",children:gt(new Date(d.date_created),"MMMM dd, yyyy")}),t.jsx(W,{className:"md:text-xs",children:d.notes||"None"}),t.jsx(W,{className:"text-right",children:t.jsxs("div",{className:"flex justify-end md:flex-col md:gap-3 items-center gap-1",children:[t.jsx(Gt,{tithe:d,editingTitheId:P,setEditingTitheId:R,handleEditTithe:p,index:f,setTithes:j}),t.jsx(ae,{variant:"destructive",size:"icon",onClick:async()=>{if((await se.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",confirmButtonColor:"#ef4444",cancelButtonText:"No, cancel!"})).isConfirmed)try{await ye.delete(`tithes/${d.id}`),$(),se.fire({icon:"success",title:"Deleted!",text:"The tithes has been deleted successfully.",timer:2e3,showConfirmButton:!1,timerProgressBar:!0})}catch(Z){console.error("Error deleting tithes:",Z),se.fire("Error!","Failed to delete tithes. Please try again.","error")}},className:"h-8 w-8 rounded-md hover:bg-red-500 hover:text-white focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:t.jsx(he,{icon:nt})})]})})]},d.id)})]}),t.jsx(mt,{children:t.jsxs(pe,{children:[t.jsx(W,{colSpan:3,className:"text-right text-xl font-bold",children:"Total Amount:"}),t.jsx(W,{className:"font-bold text-xl",children:g.toLocaleString("en-US",{style:"currency",currency:"PHP"})}),t.jsx(W,{colSpan:5})]})})]})})]})})})}),t.jsx(ae,{onClick:()=>S(!0),className:"fixed bottom-20 right-4 w-12 h-12 rounded-full bg-primary text-white shadow-lg flex items-center justify-center",children:t.jsx(he,{icon:Oe})}),t.jsx(Lt,{isDialogOpen:C,setIsDialogOpen:S,rows:r,setRows:s,selectedMembers:e,setSelectedMembers:a,members:n,errors:x,handleSubmit:z,loading:m,isAddDisabled:h})]})}export{Jt as default};
